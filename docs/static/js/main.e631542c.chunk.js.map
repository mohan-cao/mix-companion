{"version":3,"sources":["Spotify.js","GenreSelector.js","KeySelector.js","BPMSlider.js","LongPress.js","SearchBar.js","ResizableFlexbox.js","Results.js","ErrorSnackbar.js","App.js","serviceWorker.js","index.js"],"names":["CamelotKeyToIntegerAndMode","1A","1B","2A","2B","3A","3B","4A","4B","5A","5B","6A","6B","7A","7B","8A","8B","9A","9B","10A","10B","11A","11B","12A","12B","handleError","resp","json","status","error","message","FetchException","this","Error","getTokenInNewWindow","client_id","redirect_url","scopes","nonce","window","crypto","getRandomValues","Uint32Array","callable_endpoint","endpoint","Array","isArray","join","Promise","resolve","reject","popup","open","spotifyCallback","token","expires","state","parseInt","close","concat","_callee","regenerator_default","a","wrap","_context","prev","next","fetch","headers","Accept","Content-Type","Authorization","sent","abrupt","stop","searchSpotify","_x2","_x3","_x4","_searchSpotify","apply","arguments","_callee2","searchTerm","type","_context2","console","log","_callee3","_ref","genres","bpm","key","songs","artist","replaceSongArtists","extractArtistToEndpoint","extractTrackToEndpoint","searchResponse","_searchResponse","_context3","arr","trackIds","map","obj","hasOwnProperty","length","track","id","slice","artistsIds","term","replace","m","p1","all","t0","GenreSelector","_this$props","props","selectedGenre","availableGenres","onChange","onRefreshClicked","style","react_default","createElement","FormControl","InputLabel","shrink","htmlFor","whiteSpace","verticalAlign","display","onClick","SvgIcon","height","fill","viewBox","d","Select","minWidth","flex","multiple","input","Input","name","value","e","target","x","MenuItem","React","PureComponent","KeySelector","classes","camelotKey","disabled","className","group","camelotMinorKey","item","camelotMajorKey","withStyles","theme","paddingLeft","spacing","fontWeight","typography","fontWeightMedium","opacity","MenuGroup","cursor","&:hover","backgroundColor","BPMSlider","min","max","selectedBpm","onBpmChange","onLongPress","width","Slider","Object","assign","callback","undefined","ms","_useState","useState","_useState2","slicedToArray","startLongPress","setStartLongPress","useEffect","timerId","setTimeout","clearTimeout","onMouseDown","onMouseUp","onMouseLeave","onTouchStart","onTouchEnd","useLongPress","orientation","newValue","valueLabelDisplay","placeholders","Track","Artist","Genre","SearchBar","flexSizing","flexGrow","flexBasis","flexShrink","marginRight","TextField","query","placeholder","InputLabelProps","disableAnimation","label","defaultProps","ResizableFlexbox","childrenWidth","children","_useResizeObserver","useResizeObserver","_useResizeObserver2","ref","justifyContent","Math","floor","flexDirection","alignItems","flexWrap","Results","data","tracks","sort","b","popularity","backgroundImage","album","images","url","margin","border","boxSizing","borderRadius","artists","art","i","href","external_urls","spotify","reduce","spanJoiner","ErrorSnackbar","onClose","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","aria-describedby","formatKey","number","isMinor","DEFAULT_TEMPO","DEFAULT_KEY_NUM","DEFAULT_KEY_IS_MINOR","push","App","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","localStorage","getItem","results","queryParams","QueryString","parse","location","hash","access_token","expires_in","opener","expiry","Date","getTime","setNewToken","history","replaceState","setItem","setState","_this2","then","str","val","toLowerCase","_this3","_x","_getGenres","getGenres","catch","code","getToken","_this4","_this$state","errors","_x5","_x6","_getRecommendationsBasedOnAttributes","getRecommendationsBasedOnAttributes","split","trim","shiftKey","_ref2","_this5","_this$state2","padding","overflow","src_KeySelector","setKey","SearchBar_SearchBar","marginLeft","setSearchTerms","GenreSelector_GenreSelector","marginTop","Button","color","variant","startSearch","handleBpmChange","src_ResizableFlexbox","Component","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","src_App_0","document","getElementById","URL","process","origin","addEventListener","response","contentType","get","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.e631542c.chunk.js","sourcesContent":["const CamelotKeyToIntegerAndMode = {\n  \"1A\":  [8,  0],   \"1B\":  [8,  1],\n  \"2A\":  [3,  0],   \"2B\":  [3,  1],\n  \"3A\":  [10, 0],   \"3B\":  [10, 1],\n  \"4A\":  [5,  0],   \"4B\":  [5,  1],\n  \"5A\":  [0,  0],   \"5B\":  [0,  1],\n  \"6A\":  [7,  0],   \"6B\":  [7,  1],\n  \"7A\":  [2,  0],   \"7B\":  [2,  1],\n  \"8A\":  [9,  0],   \"8B\":  [9,  1],\n  \"9A\":  [4,  0],   \"9B\":  [4,  1],\n  \"10A\": [11, 0],   \"10B\": [11, 1],\n  \"11A\": [6,  0],   \"11B\": [6,  1],\n  \"12A\": [1,  0],   \"12B\": [1,  1],\n}\n\nfunction secureMathRandom() {\n  // Divide a random UInt32 by the maximum value (2^32 -1) to get a result between 0 and 1\n  return window.crypto.getRandomValues(new Uint32Array(1))[0] // 4294967295;\n}\n\nfunction handleError(resp, json) {\n  if (resp.status === 401) throw resp.status\n  if (resp.status !== 200) {\n    if (json && json.error && json.error.message) throw json.error.message\n    throw resp.status\n  }\n}\n\nclass FetchException extends Error {\n  toString() {\n    return this.message\n  }\n}\n\nexport function getTokenInNewWindow(client_id, redirect_url, scopes) {\n  const endpoint = \"https://accounts.spotify.com/authorize\"\n  let nonce = secureMathRandom();\n  let callable_endpoint = endpoint + \"?response_type=token\"\n  callable_endpoint += \"&redirect_uri=\" + redirect_url\n  callable_endpoint += \"&client_id=\" + client_id\n  if (scopes) callable_endpoint += \"&scopes=\" + (Array.isArray(scopes) ? scopes.join(' ') : scopes)\n  callable_endpoint += \"&state=\" + nonce\n\n  return new Promise((resolve, reject) => {\n    let popup = window.open(callable_endpoint, 'Login with Spotify', 'width=800,height=600')\n    window.spotifyCallback = (token, expires, state) => {\n      state = parseInt(state)\n      popup.close()\n      if (state !== nonce) {\n        reject(`Nonce is invalid, expected: ${nonce} but got ${state}`)\n      } else {\n        resolve({ token: token, expires: expires })\n      }\n    }\n  })\n}\n\nexport async function getGenres(token) {\n  const endpoint = \"https://api.spotify.com/v1/recommendations/available-genre-seeds\"\n  const resp = await fetch(endpoint, {\n    headers: {\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    }\n  })\n  if (resp.status !== 200) return Promise.reject()\n  return resp.json()\n}\n\nexport async function searchSpotify(token, searchTerm, type) {\n  if (!searchTerm) return Promise.reject(\"No search terms provided\")\n  const endpoint = \"https://api.spotify.com/v1/search?q=\" + searchTerm + \"&type=\" + type\n  console.log(endpoint)\n  const resp = await fetch(endpoint, {\n    headers: {\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    }\n  })\n  const json = await resp.json()\n  handleError(resp, json)\n  return json\n}\n\nexport async function getRecommendationsBasedOnAttributes(token, { genres, bpm, key, songs, artist }) {\n  // artist: kanye west, song: dark fantasy\n  function replaceSongArtists(term) {\n    return term.replace(/\\s*\\((.*)\\)\\s*/g, (m, p1) => ` artist:\"${p1}\" `)\n  }\n\n  function extractArtistToEndpoint(arr) {\n    if(!Array.isArray(arr)) throw new FetchException(400)\n    const artistsIds = arr.map(obj => {\n      if (!obj.hasOwnProperty(\"artists\") || !obj[\"artists\"][\"items\"].length) return \"\";\n      return obj[\"artists\"][\"items\"].map(track => track.id).slice(0, 1).join('')\n    }).join(',');\n    if (!artistsIds) throw new FetchException(\"No artists found using your search terms\")\n    return \"&seed_artists=\" + artistsIds\n  }\n  function extractTrackToEndpoint(arr) {\n    if(!Array.isArray(arr)) throw new FetchException(400)\n    const trackIds = arr.map(obj => {\n      if (!obj.hasOwnProperty(\"tracks\") || !obj[\"tracks\"][\"items\"].length) return \"\";\n      return obj[\"tracks\"][\"items\"].map(track => track.id).slice(0, 1).join('')\n    }).join(',')\n    if (!trackIds) throw new FetchException(\"No tracks found using your search terms\")\n    return \"&seed_tracks=\" + trackIds\n  }\n\n  const endpoint = \"https://api.spotify.com/v1/recommendations\"\n  let callable_endpoint = endpoint + \"?min_key=\" + CamelotKeyToIntegerAndMode[key][0] + \"&max_key=\" + CamelotKeyToIntegerAndMode[key][0]\n  callable_endpoint += \"&min_mode=\" + CamelotKeyToIntegerAndMode[key][1] + \"&max_mode=\" + CamelotKeyToIntegerAndMode[key][1]\n  if (Array.isArray(bpm) && bpm.length === 2) callable_endpoint += \"&min_tempo=\" + bpm[0] + \"&max_tempo=\" + bpm[1]\n  else callable_endpoint += \"&min_tempo=\" + (bpm - 10) + \"&max_tempo=\" + (bpm + 10)\n  \n  try {\n    if (songs) {\n      const searchResponse = await Promise.all((Array.isArray(songs) ? songs : [songs]).map((term) => searchSpotify(token, replaceSongArtists(term), \"track\")))\n      callable_endpoint += extractTrackToEndpoint(searchResponse)\n    } else if (artist) {\n      const searchResponse = await Promise.all((Array.isArray(artist) ? artist : [artist]).map((term) => searchSpotify(token, term, \"artist\")))\n      callable_endpoint += extractArtistToEndpoint(searchResponse)\n    } else if (genres) {\n      callable_endpoint += \"&seed_genres=\" + (Array.isArray(genres) ? genres.join(',') : genres)\n    } else {\n      return Promise.reject(\"No search terms!\")\n    }\n  } catch (status) {\n    if (typeof status === 'number' && status === 400) return Promise.reject(\"Server fucked up\");\n    else return Promise.reject(status)\n  }\n  \n\n  console.log(callable_endpoint)\n  const resp = await fetch(callable_endpoint, {\n    headers: {\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    }\n  })\n  const json = await resp.json()\n  handleError(resp, json)\n  return json\n}","import React from 'react';\nimport { Select, MenuItem, FormControl, InputLabel, Input, SvgIcon } from '@material-ui/core';\n\nexport default class GenreSelector extends React.PureComponent {\n  render() {\n    const { selectedGenre, availableGenres, onChange, onRefreshClicked, style } = this.props;\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink htmlFor=\"genre\" style={{ whiteSpace: 'nowrap' }}>\n          <span style={{ verticalAlign: 'top' }}>Genre</span>\n          <div style={{ display: 'inline' }} onClick={() => onRefreshClicked()}><SvgIcon style={{ height: '0.9rem', fill: '#393' }} viewBox=\"0 0 24 24\">\n            <path d=\"M 9 3 C 8.448 3 8 3.448 8 4 C 8 4.552 8.448 5 9 5 L 18 5 C 18.552 5 19 5.448 19 6 L 19 15 L 17 15 C 16.596 15 16.231172 15.243188 16.076172 15.617188 C 16.025172 15.741187 16 15.871 16 16 C 16 16.26 16.101969 16.516031 16.292969 16.707031 L 19.292969 19.707031 C 19.683969 20.098031 20.317031 20.098031 20.707031 19.707031 L 23.707031 16.707031 C 23.993031 16.421031 24.077828 15.992188 23.923828 15.617188 C 23.768828 15.243187 23.404 15 23 15 L 21 15 L 21 6 C 21 4.343 19.657 3 18 3 L 9 3 z M 4 4 C 3.744125 4 3.4879687 4.0974687 3.2929688 4.2929688 L 0.29296875 7.2929688 C 0.00696875 7.5789687 -0.077828125 8.0078125 0.076171875 8.3828125 C 0.23117187 8.7568125 0.596 9 1 9 L 3 9 L 3 18 C 3 19.657 4.343 21 6 21 L 15 21 C 15.552 21 16 20.552 16 20 C 16 19.448 15.552 19 15 19 L 6 19 C 5.448 19 5 18.552 5 18 L 5 9 L 7 9 C 7.404 9 7.7688281 8.7568125 7.9238281 8.3828125 C 7.9748281 8.2588125 8 8.129 8 8 C 8 7.74 7.8980312 7.4839687 7.7070312 7.2929688 L 4.7070312 4.2929688 C 4.5115312 4.0974687 4.255875 4 4 4 z\"/>\n          </SvgIcon></div>\n        </InputLabel>\n        <Select\n          style={{ minWidth: 70, flex: 1 }}\n          multiple\n          input={<Input name=\"genre\" />}\n          value={selectedGenre}\n          onChange={(e) => onChange(e.target.value)}\n        >\n          {(availableGenres && availableGenres.length > 0 ?\n            availableGenres.map((x) => <MenuItem key={x} value={x}>{x.replace(/-/g, ' ')}</MenuItem>) : <MenuItem>No genres available</MenuItem>)}\n        </Select>\n      </FormControl>\n    );\n  }\n}\n","import React from 'react';\nimport { withStyles, Select, MenuItem, FormControl, InputLabel, Input } from '@material-ui/core';\n\nclass KeySelector extends React.PureComponent {\n  static camelotMinorKey = [\n    \"1A\", \"2A\", \"3A\", \"4A\", \"5A\", \"6A\", \"7A\", \"8A\", \"9A\", \"10A\", \"11A\", \"12A\",\n  ];\n  static camelotMajorKey = [\n    \"1B\", \"2B\", \"3B\", \"4B\", \"5B\", \"6B\", \"7B\", \"8B\", \"9B\", \"10B\", \"11B\", \"12B\",\n  ];\n  render() {\n    const { classes, camelotKey, onChange, style } = this.props;\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink htmlFor=\"key\">\n          Key\n        </InputLabel>\n        <Select input={<Input name=\"key\" />} name=\"key\" value={camelotKey} onChange={(e) => onChange(e)}>\n          <MenuItem disabled className={classes.group}>Minor keys</MenuItem>\n          {KeySelector.camelotMinorKey.map((x) => <MenuItem key={x} className={classes.item} value={x}>{x}</MenuItem>)}\n          <MenuItem disabled className={classes.group}>Major keys</MenuItem>\n          {KeySelector.camelotMajorKey.map((x) => <MenuItem key={x} className={classes.item} value={x}>{x}</MenuItem>)}\n        </Select>\n      </FormControl>\n    );\n  }\n}\n\nconst styles = (theme) => ({\n  item: {\n    paddingLeft: theme.spacing(3),\n  },\n  group: {\n    fontWeight: theme.typography.fontWeightMedium,\n    opacity: 1,\n  },\n  MenuItem: {\n    paddingLeft: theme.spacing(3)\n  },\n  MenuGroup: {\n    fontWeight: theme.typography.fontWeightMedium,\n    opacity: 1,\n    cursor: \"default\",\n    \"&:hover\": {\n      backgroundColor: \"transparent !important\"\n    }\n  }\n})\n\nexport default withStyles(styles)(KeySelector)","import React from 'react';\nimport { InputLabel } from '@material-ui/core';\nimport { Slider } from '@material-ui/lab';\nimport useLongPress from './LongPress';\n\nexport default function BPMSlider({ min, max, height, selectedBpm, onBpmChange, onLongPress }) {\n  return (\n    <div>\n      <InputLabel style={{ width: '100%' }} shrink>BPM</InputLabel>\n      <div style={{ display: 'flex', height: height }}>\n        <Slider\n          {...useLongPress(onLongPress, 500)}\n          orientation=\"vertical\"\n          min={min} max={max}\n          value={selectedBpm}\n          onChange={(e, newValue) => onBpmChange(e, newValue)}\n          valueLabelDisplay=\"auto\"\n        />\n      </div>\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\n\nexport default function useLongPress(callback = () => {}, ms = 300) {\n  const [startLongPress, setStartLongPress] = useState(false);\n\n  useEffect(() => {\n    let timerId;\n    if (startLongPress) {\n      timerId = setTimeout(callback, ms);\n    } else {\n      clearTimeout(timerId);\n    }\n\n    return () => {\n      clearTimeout(timerId);\n    };\n  }, [callback, ms, startLongPress]);\n\n  return {\n    onMouseDown: () => { setStartLongPress(true); return true; },\n    onMouseUp: () => { setStartLongPress(false); return true; },\n    onMouseLeave: () => { setStartLongPress(false); return true; },\n    onTouchStart: () => { setStartLongPress(true); return true; },\n    onTouchEnd: () => { setStartLongPress(false); return true; },\n  };\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { FormControl, TextField, Select, MenuItem, InputLabel } from '@material-ui/core';\n\nconst placeholders = {\n  \"Track\": \"Never Gonna Give You Up, Robot Rock\",\n  \"Artist\": \"Kanye West\",\n  \"Genre\": \"Pop, Rock, Country\"\n}\n\nexport default class SearchBar extends React.PureComponent {\n  render() {\n    const { style, type, value, onChange, GenreSelector } = this.props;\n    const flexSizing = (style.flex ? { flex: style.flex } : { flexGrow: style.flexGrow, flexBasis: style.flexBasis, flexShrink: style.flexShrink })\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink style={{ whiteSpace: 'nowrap' }}>\n          Type\n        </InputLabel>\n        <Select value={type} onChange={(e) => onChange({ type: e.target.value })} style={{ marginRight: 5 }}>\n          <MenuItem value=\"Track\">Track</MenuItem>\n          <MenuItem value=\"Artist\">Artist</MenuItem>\n          <MenuItem value=\"Genre\">Genre</MenuItem>\n        </Select>\n        {\n          (type === \"Genre\") ?\n          GenreSelector\n          :\n          <TextField\n            value={value}\n            onChange={(e) => onChange({ query: e.target.value })}\n            style={flexSizing}\n            placeholder={placeholders[type]}\n            InputLabelProps={{ shrink: true, disableAnimation: false }}\n            label=\"Search\"\n          />\n        }\n      </FormControl>\n    );\n  }\n}\n\nSearchBar.defaultProps = {\n  type: \"Track\"\n}\n\nSearchBar.propTypes = {\n  type: PropTypes.oneOf([\"Track\", \"Artist\", \"Genre\"])\n}","import React from 'react';\nimport useResizeObserver from \"use-resize-observer\";\n\nconst ResizableFlexbox = ({ childrenWidth, children }) => {\n  const [ref, width] = useResizeObserver();\n  return (<div ref={ref} style={{\n    width: '100%',\n    display: 'flex',\n    justifyContent: 'center'\n  }}>\n    <div style={{\n      width: Math.floor(width / childrenWidth) * childrenWidth + 1,\n      display: 'flex', flexDirection: 'row',\n      justifyContent: 'flex-start', alignItems: 'center',\n      flexWrap: 'wrap'\n    }}>\n      {children}\n    </div>\n  </div>);\n};\n\nexport default ResizableFlexbox;\n","import React from 'react';\nimport { spanJoiner } from './App';\n\nexport default function Results({ data }) {\n  if (!data || !data.tracks || data.tracks.length < 1)\n    return <div />;\n  return data.tracks.sort((a, b) => b.popularity - a.popularity).map((track) => (<div key={track.id} style={{ backgroundImage: `url(${track.album ? track.album.images[0].url : ''})`, margin: 2, backgroundColor: '#999', border: '2px solid #aaa', boxSizing: 'content-box' }}>\n    <div style={{ margin: 5, border: '0.5px solid #aaa', backgroundColor: 'rgba(0, 0, 0, 0.8)', borderRadius: '50%', height: 200, width: 200, display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center' }}>\n      <h1 className=\"artist-name\">{track.artists.map((art, i) => <a className=\"artist-name\" key={art.id + \"\" + i} href={art.external_urls.spotify}>{art.name}</a>).reduce(spanJoiner, [])}</h1>\n      <h2 className=\"song-name\"><a className=\"song-name\" href={track.external_urls.spotify}>{track.name}</a></h2>\n    </div>\n  </div>));\n}\n","import React from 'react';\nimport { Snackbar } from '@material-ui/core';\n\nexport default function ErrorSnackbar({ open, error, onClose }) {\n  return (<Snackbar anchorOrigin={{\n    vertical: 'bottom',\n    horizontal: 'left',\n  }} open={open} onClose={onClose} autoHideDuration={6000} ContentProps={{\n    'aria-describedby': 'message-id',\n  }} message={<span id=\"message-id\">Error: {error} </span>} />);\n}\n","import React from 'react';\nimport './App.css';\nimport QueryString from 'query-string'\nimport { getTokenInNewWindow, getRecommendationsBasedOnAttributes, getGenres } from './Spotify';\nimport GenreSelector from './GenreSelector';\nimport KeySelector from './KeySelector';\nimport { Button } from '@material-ui/core';\nimport BPMSlider from './BPMSlider';\nimport SearchBar from './SearchBar';\nimport ResizableFlexbox from './ResizableFlexbox';\nimport Results from './Results';\nimport ErrorSnackbar from './ErrorSnackbar';\n\nconst formatKey = (number, isMinor) => number + (isMinor ? \"B\" : \"A\")\nconst stringToKey = (str) => [ parseInt(str.slice(0, -1)), (str.slice(-1).toLowerCase() === \"b\" ? true : false)]\nconst DEFAULT_TEMPO = 120\nconst DEFAULT_KEY_NUM = 1\nconst DEFAULT_KEY_IS_MINOR = false\nconst website = \"https://www.mohancao.me/mix-companion\"\n\nexport const spanJoiner = (a, b) => {\n  if (a.length === 0) a.push(b)\n  else a.push(<br key={a.length+1}/>, b)\n  return a\n}\n\nclass App extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      number: DEFAULT_KEY_NUM,\n      isMinor: DEFAULT_KEY_IS_MINOR,\n      token: window.localStorage.getItem(\"token\"),\n      expires: window.localStorage.getItem(\"expires\"),\n      availableGenres: ['country', 'classical', 'rock', 'pop', 'blues', 'r-n-b'],\n      results: 'Results go here',\n      selectedBpm: DEFAULT_TEMPO,\n\n      type: \"Track\",\n      query: \"\",\n    }\n  }\n\n  componentDidMount() {\n    /// block start\n    {\n      let queryParams = QueryString.parse(window.location.hash)\n      if (!queryParams) return;\n      let { access_token, expires_in, state } = queryParams;\n      if (window.opener && window.opener.spotifyCallback) {\n        window.opener.spotifyCallback(access_token, expires_in, state)\n      } else if (access_token && expires_in) {\n        let expiry = (new Date().getTime() + (parseInt(expires_in) * 1000 * 0.9))\n        this.setNewToken(access_token, expiry) // always refresh a little earlier than needed (0.9*actual expiry time)\n      }\n      window.history.replaceState(null, null, ' ');\n    }\n    /// block end\n  }\n\n  setNewToken(token, expires) {\n    if (window.localStorage.getItem(\"token\") === token){\n      return;\n    } else {\n      window.localStorage.setItem(\"token\", token)\n      window.localStorage.setItem(\"expires\", expires)\n      this.setState({ token: token, expires: expires })\n    }\n  }\n\n  getToken() {\n    getTokenInNewWindow(\"4a4e5068f705407480266c7e7c8d7dfa\", website).then(({ token, expires }) => {\n      this.setNewToken(token, expires)\n    })\n  }\n\n  setKey(e) {\n    const val = stringToKey(e.target.value)\n    this.setState({ number: val[0] ? val[0] : DEFAULT_KEY_NUM, isMinor: val[1] ? val[1] : DEFAULT_KEY_IS_MINOR })\n  }\n\n  getGenres() {\n    getGenres(this.state.token)\n    .then(x => this.setState({ availableGenres: x.genres }))\n    .catch((code) => {\n      // token expired\n      if (code === 401) this.getToken();\n      else this.setState({ error: ''+code });\n    })\n  }\n\n  startSearch() {\n    const { token, selectedBpm, number, isMinor, type, query } = this.state;\n\n    let errors = ''\n    if (type === \"Genre\" && query && query.length && query.length > 5) errors += \"Sorry, can't have more than 5 genres. \"\n    if (errors) { this.setState({ error: errors }); return; }\n\n    getRecommendationsBasedOnAttributes(token, {\n      genres: (type === 'Genre' ? query : null),\n      bpm: selectedBpm,\n      key: formatKey(number, isMinor),\n      songs: (type === 'Track' ? query.split(',').map(x => x.trim()) : null),\n      artist: (type === 'Artist' ? query.split(',').map(x => x.trim()) : null),\n    })\n    .then(x => this.setState({ results: x }))\n    .catch((code) => {\n      // token expired\n      if (code === 401) this.getToken()\n      else this.setState({ error: ''+code })\n    })\n  }\n\n  handleBpmChange(e, newValue) {\n    if (e.shiftKey && typeof this.state.selectedBpm === 'number') newValue = [this.state.selectedBpm, newValue] \n    else if (Array.isArray(newValue) && newValue[0] === newValue[1]) newValue = newValue[0]\n    this.setState({ selectedBpm: newValue })\n  }\n\n  setSearchTerms({ query, type }) {\n    if (type) {\n      this.setState({ type, query: '' })\n    } else {\n      this.setState({ query })\n    }\n  }\n\n  render() {\n    const { number, isMinor, token, results, availableGenres, selectedBpm, type, query, error } = this.state;\n    if (!token) return <div className=\"App\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}><Button onClick={() => this.getToken()}>Login to Spotify to use this app</Button></div>\n    return (\n      <div className=\"App\">\n        <ErrorSnackbar open={!!error} error={error} onClose={() => this.setState({ error: null })} />\n        <div style={{ backgroundColor: '#eee', padding: 15, boxSizing: 'border-box', display: 'inline-flex', width: '100vw', justifyContent: 'center', flexWrap: 'wrap' }}>\n          <div style={{ display: 'flex', flexDirection: 'column', width: '70%', flex: '1 1 auto', overflow: 'auto' }}>\n            <div style={{ display: 'flex' }}>\n              <KeySelector style={{ flexDirection: 'row', flex: '0 0 auto', alignItems: 'center' }} camelotKey={formatKey(number, isMinor)} onChange={(e) => this.setKey(e)} />\n              <SearchBar style={{ flexDirection: 'row', flex: '1 1 150px', minWidth: '150px', alignItems: 'center', marginLeft: 5 }}\n                         type={type}\n                         value={query}\n                         onChange={(e) => this.setSearchTerms(e)}\n                         GenreSelector={<GenreSelector\n                                         style={{ flexDirection: 'row', flex: '1 1 auto', alignItems: 'center', marginLeft: 5 }}\n                                         selectedGenre={type === 'Genre' && Array.isArray(query) ? query : []} availableGenres={availableGenres}\n                                         onChange={(val) => (val.length <= 5) && this.setState({ query: val })}\n                                         onRefreshClicked={() => this.getGenres()}\n                                        />}\n              />\n            </div>\n            <div style={{ marginTop: 5 }}>\n              <Button style={{ width: '100%' }} color=\"primary\" variant=\"contained\" onClick={() => this.startSearch()}>Start search</Button>\n            </div>\n          </div>\n          <div style={{ flex: '0 1 auto' }}>\n            <BPMSlider onLongPress={() => this.handleBpmChange({}, [50, 250])} selectedBpm={selectedBpm} onBpmChange={(e, newValue) => this.handleBpmChange(e, newValue)} height={75} min={0} max={300} />\n          </div>\n        </div>\n        <div style={{ marginTop: 5 }}>\n          Getting recommendations for {type.toLowerCase()}s <span style={{ color: 'red' }}>{query ? (\"like \" + (Array.isArray(query)?query.join(', ') : query)) : ''}</span>\n        </div>\n        <div style={{ padding: '20px 0', display: 'flex', justifyContent: 'center' }}>\n          <ResizableFlexbox childrenWidth={219}>\n            <Results data={results} />\n          </ResizableFlexbox>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}