{"version":3,"sources":["Spotify.js","GenreSelector.js","KeySelector.js","App.js","serviceWorker.js","index.js"],"names":["CamelotKeyToIntegerAndMode","1A","1B","2A","2B","3A","3B","4A","4B","5A","5B","6A","6B","7A","7B","8A","8B","9A","9B","10A","10B","11A","11B","12A","12B","getTokenInNewWindow","client_id","redirect_url","scopes","nonce","window","crypto","getRandomValues","Uint32Array","callable_endpoint","endpoint","Array","isArray","join","Promise","resolve","reject","popup","open","spotifyCallback","token","expires","state","parseInt","close","concat","_callee","resp","regenerator_default","a","wrap","_context","prev","next","fetch","headers","Accept","Content-Type","Authorization","sent","status","abrupt","json","stop","_callee2","_ref","genres","bpm","key","_context2","length","console","log","GenreSelector","_this$props","this","props","selectedGenre","availableGenres","onChange","onRefreshClicked","style","react_default","createElement","FormControl","InputLabel","shrink","htmlFor","display","onClick","SvgIcon","height","fill","viewBox","d","Select","minWidth","multiple","input","Input","name","value","e","target","map","x","MenuItem","replace","React","PureComponent","KeySelector","classes","camelotKey","disabled","className","group","camelotMinorKey","item","camelotMajorKey","withStyles","theme","paddingLeft","spacing","fontWeight","typography","fontWeightMedium","opacity","MenuGroup","cursor","&:hover","backgroundColor","formatKey","number","isMinor","DEFAULT_TEMPO","DEFAULT_KEY_NUM","DEFAULT_KEY_IS_MINOR","spanJoiner","b","push","App","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","localStorage","getItem","results","selectedBpm","queryParams","QueryString","parse","location","hash","access_token","expires_in","opener","expiry","Date","getTime","setNewToken","setItem","setState","_this2","then","str","val","slice","toLowerCase","_this3","_x","_getGenres","apply","arguments","getGenres","catch","getToken","_this4","_this$state","_x2","_x3","_getRecommendationsBasedOnAttributes","getRecommendationsBasedOnAttributes","tracks","sort","popularity","track","id","backgroundImage","album","images","url","margin","border","boxSizing","borderRadius","width","flexDirection","alignItems","justifyContent","artists","art","i","href","external_urls","spotify","reduce","newValue","shiftKey","_this5","_this$state2","padding","flexWrap","src_KeySelector","setKey","GenreSelector_GenreSelector","marginLeft","marginTop","Button","color","variant","startSearch","Slider","orientation","min","max","handleBpmChange","valueLabelDisplay","mapResults","Component","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","error","ReactDOM","render","src_App_0","document","getElementById","URL","process","origin","addEventListener","response","contentType","get","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.727d13a1.chunk.js","sourcesContent":["const CamelotKeyToIntegerAndMode = {\n  \"1A\":  [8,  0],   \"1B\":  [8,  1],\n  \"2A\":  [3,  0],   \"2B\":  [3,  1],\n  \"3A\":  [10, 0],   \"3B\":  [10, 1],\n  \"4A\":  [5,  0],   \"4B\":  [5,  1],\n  \"5A\":  [0,  0],   \"5B\":  [0,  1],\n  \"6A\":  [7,  0],   \"6B\":  [7,  1],\n  \"7A\":  [2,  0],   \"7B\":  [2,  1],\n  \"8A\":  [9,  0],   \"8B\":  [9,  1],\n  \"9A\":  [4,  0],   \"9B\":  [4,  1],\n  \"10A\": [11, 0],   \"10B\": [11, 1],\n  \"11A\": [6,  0],   \"11B\": [6,  1],\n  \"12A\": [1,  0],   \"12B\": [1,  1],\n}\n\nfunction secureMathRandom() {\n  // Divide a random UInt32 by the maximum value (2^32 -1) to get a result between 0 and 1\n  return window.crypto.getRandomValues(new Uint32Array(1))[0] // 4294967295;\n}\n\nexport function getTokenInNewWindow(client_id, redirect_url, scopes) {\n  const endpoint = \"https://accounts.spotify.com/authorize\"\n  let nonce = secureMathRandom();\n  let callable_endpoint = endpoint + \"?response_type=token\"\n  callable_endpoint += \"&redirect_uri=\" + redirect_url\n  callable_endpoint += \"&client_id=\" + client_id\n  if (scopes) callable_endpoint += \"&scopes=\" + (Array.isArray(scopes) ? scopes.join(' ') : scopes)\n  callable_endpoint += \"&state=\" + nonce\n\n  return new Promise((resolve, reject) => {\n    let popup = window.open(callable_endpoint, 'Login with Spotify', 'width=800,height=600')\n    window.spotifyCallback = (token, expires, state) => {\n      state = parseInt(state)\n      popup.close()\n      if (state !== nonce) {\n        reject(`Nonce is invalid, expected: ${nonce} but got ${state}`)\n      } else {\n        resolve({ token: token, expires: expires })\n      }\n    }\n  })\n}\n\nexport async function getGenres(token) {\n  const endpoint = \"https://api.spotify.com/v1/recommendations/available-genre-seeds\"\n  const resp = await fetch(endpoint, {\n    headers: {\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    }\n  })\n  if (resp.status !== 200) return Promise.reject()\n  return resp.json()\n}\n\nexport async function getRecommendationsBasedOnAttributes(token, { genres, bpm, key }) {\n  const endpoint = \"https://api.spotify.com/v1/recommendations\"\n  let callable_endpoint = endpoint + \"?seed_genres=\" + (Array.isArray(genres) ? genres.join(',') : genres)\n  callable_endpoint += \"&min_key=\" + CamelotKeyToIntegerAndMode[key][0] + \"&max_key=\" + CamelotKeyToIntegerAndMode[key][0]\n  callable_endpoint += \"&min_mode=\" + CamelotKeyToIntegerAndMode[key][1] + \"&max_mode=\" + CamelotKeyToIntegerAndMode[key][1]\n  if (Array.isArray(bpm) && bpm.length === 2) callable_endpoint += \"&min_tempo=\" + bpm[0] + \"&max_tempo=\" + bpm[1]\n  else callable_endpoint += \"&target_tempo=\" + bpm\n  console.log(callable_endpoint)\n  const resp = await fetch(callable_endpoint, {\n    headers: {\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    }\n  })\n  if (resp.status !== 200) return Promise.reject()\n  return resp.json()\n}","import React from 'react';\nimport { Select, MenuItem, FormControl, InputLabel, Input, SvgIcon } from '@material-ui/core';\n\nexport default class GenreSelector extends React.PureComponent {\n  render() {\n    const { selectedGenre, availableGenres, onChange, onRefreshClicked, style } = this.props;\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink htmlFor=\"genre\">\n          <span>Genre</span>\n          <div style={{ display: 'inline' }} onClick={() => onRefreshClicked()}><SvgIcon style={{ height: '0.9rem', fill: '#393' }} viewBox=\"0 0 24 24\">\n            <path d=\"M 9 3 C 8.448 3 8 3.448 8 4 C 8 4.552 8.448 5 9 5 L 18 5 C 18.552 5 19 5.448 19 6 L 19 15 L 17 15 C 16.596 15 16.231172 15.243188 16.076172 15.617188 C 16.025172 15.741187 16 15.871 16 16 C 16 16.26 16.101969 16.516031 16.292969 16.707031 L 19.292969 19.707031 C 19.683969 20.098031 20.317031 20.098031 20.707031 19.707031 L 23.707031 16.707031 C 23.993031 16.421031 24.077828 15.992188 23.923828 15.617188 C 23.768828 15.243187 23.404 15 23 15 L 21 15 L 21 6 C 21 4.343 19.657 3 18 3 L 9 3 z M 4 4 C 3.744125 4 3.4879687 4.0974687 3.2929688 4.2929688 L 0.29296875 7.2929688 C 0.00696875 7.5789687 -0.077828125 8.0078125 0.076171875 8.3828125 C 0.23117187 8.7568125 0.596 9 1 9 L 3 9 L 3 18 C 3 19.657 4.343 21 6 21 L 15 21 C 15.552 21 16 20.552 16 20 C 16 19.448 15.552 19 15 19 L 6 19 C 5.448 19 5 18.552 5 18 L 5 9 L 7 9 C 7.404 9 7.7688281 8.7568125 7.9238281 8.3828125 C 7.9748281 8.2588125 8 8.129 8 8 C 8 7.74 7.8980312 7.4839687 7.7070312 7.2929688 L 4.7070312 4.2929688 C 4.5115312 4.0974687 4.255875 4 4 4 z\"/>\n          </SvgIcon></div>\n        </InputLabel>\n        <Select\n          style={{ minWidth: 70 }}\n          multiple\n          input={<Input name=\"genre\" />}\n          value={selectedGenre}\n          onChange={(e) => onChange({ selectedGenre: e.target.value })}\n        >\n          {(availableGenres && availableGenres.length > 0 ?\n            availableGenres.map((x) => <MenuItem key={x} value={x}>{x.replace(/-/g, ' ')}</MenuItem>) : <MenuItem>No genres available</MenuItem>)}\n        </Select>\n      </FormControl>\n    );\n  }\n}\n","import React from 'react';\nimport { withStyles, Select, MenuItem, FormControl, InputLabel, Input } from '@material-ui/core';\n\nclass KeySelector extends React.PureComponent {\n  static camelotMinorKey = [\n    \"1A\", \"2A\", \"3A\", \"4A\", \"5A\", \"6A\", \"7A\", \"8A\", \"9A\", \"10A\", \"11A\", \"12A\",\n  ];\n  static camelotMajorKey = [\n    \"1B\", \"2B\", \"3B\", \"4B\", \"5B\", \"6B\", \"7B\", \"8B\", \"9B\", \"10B\", \"11B\", \"12B\",\n  ];\n  render() {\n    const { classes, camelotKey, onChange, style } = this.props;\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink htmlFor=\"key\">\n          Key\n        </InputLabel>\n        <Select input={<Input name=\"key\" />} name=\"key\" value={camelotKey} onChange={(e) => onChange(e)}>\n          <MenuItem disabled className={classes.group}>Minor keys</MenuItem>\n          {KeySelector.camelotMinorKey.map((x) => <MenuItem key={x} className={classes.item} value={x}>{x}</MenuItem>)}\n          <MenuItem disabled className={classes.group}>Major keys</MenuItem>\n          {KeySelector.camelotMajorKey.map((x) => <MenuItem key={x} className={classes.item} value={x}>{x}</MenuItem>)}\n        </Select>\n      </FormControl>\n    );\n  }\n}\n\nconst styles = (theme) => ({\n  item: {\n    paddingLeft: theme.spacing(3),\n  },\n  group: {\n    fontWeight: theme.typography.fontWeightMedium,\n    opacity: 1,\n  },\n  MenuItem: {\n    paddingLeft: theme.spacing(3)\n  },\n  MenuGroup: {\n    fontWeight: theme.typography.fontWeightMedium,\n    opacity: 1,\n    cursor: \"default\",\n    \"&:hover\": {\n      backgroundColor: \"transparent !important\"\n    }\n  }\n})\n\nexport default withStyles(styles)(KeySelector)","import React from 'react';\nimport './App.css';\nimport QueryString from 'query-string'\nimport { getTokenInNewWindow, getRecommendationsBasedOnAttributes, getGenres } from './Spotify';\nimport GenreSelector from './GenreSelector';\nimport KeySelector from './KeySelector';\nimport { Button, InputLabel } from '@material-ui/core';\nimport { Slider } from '@material-ui/lab';\n\nconst formatKey = (number, isMinor) => number + (isMinor ? \"B\" : \"A\")\nconst stringToKey = (str) => [ parseInt(str.slice(0, -1)), (str.slice(-1).toLowerCase() === \"b\" ? true : false)]\nconst DEFAULT_TEMPO = 120\nconst DEFAULT_KEY_NUM = 1\nconst DEFAULT_KEY_IS_MINOR = false\nconst website = \"https://www.mohancao.me/mix-companion\"\n\nconst spanJoiner = (a, b) => {\n  if (a.length === 0) a.push(b)\n  else a.push(<br key={a.length+1}/>, b)\n  return a\n}\n\nclass App extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      number: DEFAULT_KEY_NUM,\n      isMinor: DEFAULT_KEY_IS_MINOR,\n      token: window.localStorage.getItem(\"token\"),\n      expires: window.localStorage.getItem(\"expires\"),\n      availableGenres: ['country', 'classical', 'rock', 'pop', 'blues', 'r-n-b'],\n      selectedGenre: ['country'],\n      results: 'Results go here',\n      selectedBpm: DEFAULT_TEMPO\n    }\n  }\n\n  componentDidMount() {\n    /// block start\n    {\n      let queryParams = QueryString.parse(window.location.hash)\n      if (!queryParams) return;\n      let { access_token, expires_in, state } = queryParams;\n      if (window.opener && window.opener.spotifyCallback) {\n        window.opener.spotifyCallback(access_token, expires_in, state)\n      } else if (access_token && expires_in) {\n        let expiry = (new Date().getTime() + (parseInt(expires_in) * 1000 * 0.9))\n        this.setNewToken(access_token, expiry) // always refresh a little earlier than needed (0.9*actual expiry time)\n      }\n      window.location.hash = \"\"\n    }\n    /// block end\n  }\n\n  setNewToken(token, expires) {\n    if (window.localStorage.getItem(\"token\") === token){\n      return;\n    } else {\n      window.localStorage.setItem(\"token\", token)\n      window.localStorage.setItem(\"expires\", expires)\n      this.setState({ token: token, expires: expires })\n    }\n  }\n\n  getToken() {\n    getTokenInNewWindow(\"4a4e5068f705407480266c7e7c8d7dfa\", website).then(({ token, expires }) => {\n      this.setNewToken(token, expires)\n    })\n  }\n\n  setKey(e) {\n    const val = stringToKey(e.target.value)\n    this.setState({ number: val[0] ? val[0] : DEFAULT_KEY_NUM, isMinor: val[1] ? val[1] : DEFAULT_KEY_IS_MINOR })\n  }\n\n  getGenres() {\n    getGenres(this.state.token)\n    .then(x => this.setState({ availableGenres: x.genres }))\n    .catch(() => {\n      // token failed\n      this.getToken();\n    })\n  }\n\n  startSearch() {\n    const { token, selectedGenre, selectedBpm, number, isMinor } = this.state;\n    getRecommendationsBasedOnAttributes(token, { genres: selectedGenre, bpm: selectedBpm, key: formatKey(number, isMinor)})\n    .then(x => this.setState({ results: x }))\n    .catch(() => {\n      // token expired\n      this.getToken()\n    })\n  }\n\n  mapResults(results) {\n    if (!results || !results.tracks || results.tracks.length < 1) return\n    console.log(results.tracks.sort((a, b) => b.popularity - a.popularity))\n    return results.tracks.sort((a, b) => b.popularity - a.popularity).map((track) => (\n      <div key={track.id} style={{ backgroundImage: `url(${track.album ? track.album.images[0].url: ''})`, margin: 2, backgroundColor: '#999', border: '3px solid #aaa', boxSizing: 'content-box' }}>\n        <div style={{ margin: 5, border: '3px solid #aaa', backgroundColor: 'rgba(0, 0, 0, 0.8)', borderRadius: '50%', height: 200, width: 200, display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center' }}>\n          <h1 className=\"artist-name\">{track.artists.map((art, i) => <a className=\"artist-name\" key={i} href={art.external_urls.spotify}>{art.name}</a>).reduce(spanJoiner, [])}</h1>\n          <h2 className=\"song-name\"><a className=\"song-name\" href={track.external_urls.spotify}>{track.name}</a></h2>\n        </div>\n      </div>\n    ))\n  }\n\n  handleBpmChange(e, newValue) {\n    if (e.shiftKey && typeof this.state.selectedBpm === 'number') newValue = [this.state.selectedBpm, newValue] \n    else if (Array.isArray(newValue) && newValue[0] === newValue[1]) newValue = newValue[0]\n    console.log(newValue)\n    this.setState({ selectedBpm: newValue })\n  }\n\n  render() {\n    const { number, isMinor, token, results, selectedGenre, availableGenres, selectedBpm } = this.state;\n    if (!token) return <div className=\"App\"><Button onClick={() => this.getToken()}>Login to Spotify to use this app</Button></div>\n    return (\n      <div className=\"App\" style={{ padding: 5 }}>\n        <div style={{ backgroundColor: '#eee', padding: 15, display: 'inline-flex', flexWrap: 'wrap' }}>\n          <div style={{ display: 'flex', flexDirection: 'column' }}>\n            <div>\n              <KeySelector style={{ flexDirection: 'row', alignItems: 'center' }} camelotKey={formatKey(number, isMinor)} onChange={(e) => this.setKey(e)} />\n              <GenreSelector style={{ flexDirection: 'row', alignItems: 'center', marginLeft: 5 }} selectedGenre={selectedGenre} availableGenres={availableGenres} onChange={(e) => this.setState(e)} onRefreshClicked={() => this.getGenres()} />\n            </div>\n            <div style={{ marginTop: 5 }}>\n              <Button style={{ width: '100%' }} color=\"primary\" variant=\"contained\" onClick={() => this.startSearch()}>Start search</Button>\n            </div>\n          </div>\n          <div>\n            <InputLabel style={{ width: '100%' }} shrink htmlFor=\"bpm\">BPM</InputLabel>\n            <div style={{ display: 'flex', height: 75 }}>\n              <Slider\n                name=\"bpm\"\n                orientation=\"vertical\"\n                min={0}\n                max={300}\n                value={selectedBpm}\n                onChange={(e, newValue) => this.handleBpmChange(e, newValue)}\n                valueLabelDisplay=\"auto\"\n              />\n            </div>\n          </div>\n        </div>\n        <div style={{ display: 'flex', flexDirection: 'row', justifyContent: 'center', alignItems: 'center', flexWrap: 'wrap' }}>\n          {this.mapResults(results)}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}