{"version":3,"sources":["Spotify.js","GenreSelector.js","KeySelector.js","BPMSlider.js","LongPress.js","SearchBar.js","ResizableFlexbox.js","Results.js","ErrorSnackbar.js","App.js","serviceWorker.js","index.js"],"names":["CamelotKeyToIntegerAndMode","1A","1B","2A","2B","3A","3B","4A","4B","5A","5B","6A","6B","7A","7B","8A","8B","9A","9B","10A","10B","11A","11B","12A","12B","handleError","resp","json","status","error","message","FetchException","this","Error","fetchJSONWithOAuthToken","_callee","endpoint","token","regenerator_default","a","wrap","_context","prev","next","fetch","headers","Accept","Content-Type","Authorization","sent","abrupt","stop","getTokenInNewWindow","client_id","redirect_url","scopes","nonce","window","crypto","getRandomValues","Uint32Array","callable_endpoint","Array","isArray","join","Promise","resolve","reject","popup","open","spotifyCallback","expires","state","parseInt","close","concat","_callee2","_context2","searchSpotify","_x4","_x5","_x6","_searchSpotify","apply","arguments","_callee3","searchTerm","type","_context3","console","log","_callee5","_ref","genres","_ref$bpm","bpm","key","songs","artist","replaceSongArtists","extractArtistToEndpoint","extractTrackToEndpoint","searchResponse","_searchResponse","mapped_responses","_context5","term","replace","m","p1","arr","artistsIds","map","obj","hasOwnProperty","length","track","id","slice","trackIds","all","t0","_ref2","Object","asyncToGenerator","mark","_callee4","k","modifiedEndpoint","_context4","value","_x9","t1","b","t2","reduce","GenreSelector","_this$props","props","selectedGenre","availableGenres","onChange","onRefreshClicked","style","react_default","createElement","FormControl","InputLabel","shrink","htmlFor","whiteSpace","verticalAlign","display","onClick","SvgIcon","height","fill","viewBox","d","Select","minWidth","flex","multiple","input","Input","name","e","target","x","MenuItem","React","PureComponent","KeySelector","classes","camelotKey","disabled","className","group","camelotMinorKey","item","camelotMajorKey","withStyles","theme","paddingLeft","spacing","fontWeight","typography","fontWeightMedium","opacity","MenuGroup","cursor","&:hover","backgroundColor","BPMSlider","min","max","selectedBpm","onBpmChange","onLongPress","width","Slider","assign","callback","undefined","ms","_useState","useState","_useState2","slicedToArray","startLongPress","setStartLongPress","useEffect","timerId","setTimeout","clearTimeout","onMouseDown","onMouseUp","onMouseLeave","onTouchStart","onTouchEnd","useLongPress","orientation","newValue","valueLabelDisplay","placeholders","Track","Artist","Genre","SearchBar","flexSizing","flexGrow","flexBasis","flexShrink","marginRight","TextField","query","placeholder","InputLabelProps","disableAnimation","label","defaultProps","ResizableFlexbox","childrenWidth","children","_useResizeObserver","useResizeObserver","_useResizeObserver2","ref","justifyContent","Math","floor","flexDirection","alignItems","flexWrap","mode","A","B","keyText","GetCamelotWheelColor","displayKey","keyHue","indexOf","keySaturationValuePair","GetCamelotWheelColorText","Results","data","keys","accumulator","musicalKey","result_obj","elements","tracks","sort","popularity","backgroundImage","album","images","url","margin","border","boxSizing","borderRadius","artists","art","i","href","external_urls","spotify","spanJoiner","push","color","fontSize","toConsumableArray","ErrorSnackbar","onClose","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","aria-describedby","formatKey","number","isMinor","DEFAULT_TEMPO","DEFAULT_KEY_NUM","DEFAULT_KEY_IS_MINOR","rotate12","amount","App","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","localStorage","getItem","results","queryParams","QueryString","parse","location","hash","access_token","expires_in","opener","expiry","Date","getTime","setNewToken","history","replaceState","setItem","setState","_this2","then","str","val","toLowerCase","_this3","_x3","_getGenres","getGenres","catch","code","getToken","_this4","_this$state","errors","_x7","_x8","_getRecommendationsBasedOnAttributes","getRecommendationsBasedOnAttributes","split","trim","shiftKey","_this5","_this$state2","padding","overflow","src_KeySelector","setKey","SearchBar_SearchBar","marginLeft","setSearchTerms","GenreSelector_GenreSelector","marginTop","Button","variant","startSearch","document","documentElement","handleBpmChange","src_ResizableFlexbox","Component","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","src_App_0","getElementById","URL","process","origin","addEventListener","response","contentType","get","ready","unregister","reload","checkValidServiceWorker"],"mappings":"+OAAMA,EAA6B,CACjCC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,KAAO,CAAC,GAAI,GAAMC,KAAO,CAAC,GAAI,GAC9BC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,KAAO,CAAC,EAAI,GAAMC,KAAO,CAAC,EAAI,GAC9BC,MAAO,CAAC,GAAI,GAAMC,MAAO,CAAC,GAAI,GAC9BC,MAAO,CAAC,EAAI,GAAMC,MAAO,CAAC,EAAI,GAC9BC,MAAO,CAAC,EAAI,GAAMC,MAAO,CAAC,EAAI,IAQhC,SAASC,EAAYC,EAAMC,GACzB,GAAoB,MAAhBD,EAAKE,OAAgB,MAAMF,EAAKE,OACpC,GAAoB,MAAhBF,EAAKE,OAAgB,CACvB,GAAID,GAAQA,EAAKE,OAASF,EAAKE,MAAMC,QAAS,MAAMH,EAAKE,MAAMC,QAC/D,MAAMJ,EAAKE,YAITG,qLAEF,OAAOC,KAAKF,2BAFaG,iBAMdC,iFAAf,SAAAC,EAAuCC,EAAUC,GAAjD,IAAAX,EAAA,OAAAY,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EACqBC,MAAMR,EAAU,CACjCS,QAAS,CACPC,OAAU,mBACVC,eAAgB,mBAChBC,cAAiB,UAAYX,KALnC,cACQX,EADRe,EAAAQ,KAAAR,EAAAS,OAAA,SAQSxB,GART,wBAAAe,EAAAU,SAAAhB,6BAWO,SAASiB,EAAoBC,EAAWC,EAAcC,GAC3D,IACIC,EA9BGC,OAAOC,OAAOC,gBAAgB,IAAIC,YAAY,IAAI,GA+BrDC,EAAoBzB,6DAMxB,OALAyB,GAAqB,iBAAmBP,EACxCO,GAAqB,cAAgBR,EACjCE,IAAQM,GAAqB,YAAcC,MAAMC,QAAQR,GAAUA,EAAOS,KAAK,KAAOT,IAC1FM,GAAqB,UAAYL,EAE1B,IAAIS,QAAQ,SAACC,EAASC,GAC3B,IAAIC,EAAQX,OAAOY,KAAKR,EAAmB,qBAAsB,wBACjEJ,OAAOa,gBAAkB,SAACjC,EAAOkC,EAASC,GACxCA,EAAQC,SAASD,GACjBJ,EAAMM,QACFF,IAAUhB,EACZW,EAAM,+BAAAQ,OAAgCnB,EAAhC,aAAAmB,OAAiDH,IAEvDN,EAAQ,CAAE7B,MAAOA,EAAOkC,QAASA,kDAMlC,SAAAK,EAAyBvC,GAAzB,IAAAX,EAAA,OAAAY,EAAAC,EAAAC,KAAA,SAAAqC,GAAA,cAAAA,EAAAnC,KAAAmC,EAAAlC,MAAA,aACY,mEADZkC,EAAAlC,KAAA,EAEcT,EADF,mEACoCG,GAFhD,UAGe,OADdX,EAFDmD,EAAA5B,MAGIrB,OAHJ,CAAAiD,EAAAlC,KAAA,eAAAkC,EAAA3B,OAAA,SAG2Be,QAAQE,UAHnC,cAAAU,EAAAlC,KAAA,EAIQjB,EAAKC,OAJb,cAAAkD,EAAA3B,OAAA,SAAA2B,EAAA5B,MAAA,wBAAA4B,EAAA1B,SAAAyB,6BAOA,SAAeE,EAAtBC,EAAAC,EAAAC,GAAA,OAAAC,EAAAC,MAAAnD,KAAAoD,sDAAO,SAAAC,EAA6BhD,EAAOiD,EAAYC,GAAhD,IAAAnD,EAAAV,EAAAC,EAAA,OAAAW,EAAAC,EAAAC,KAAA,SAAAgD,GAAA,cAAAA,EAAA9C,KAAA8C,EAAA7C,MAAA,UACA2C,EADA,CAAAE,EAAA7C,KAAA,eAAA6C,EAAAtC,OAAA,SACmBe,QAAQE,OAAO,6BADlC,cAEC/B,EAAW,uCAAyCkD,EAAa,SAAWC,EAClFE,QAAQC,IAAItD,GAHPoD,EAAA7C,KAAA,EAIcT,EAAwBE,EAAUC,GAJhD,cAICX,EAJD8D,EAAAvC,KAAAuC,EAAA7C,KAAA,EAKcjB,EAAKC,OALnB,cAKCA,EALD6D,EAAAvC,KAMLxB,EAAYC,EAAMC,GANb6D,EAAAtC,OAAA,SAOEvB,GAPF,yBAAA6D,EAAArC,SAAAkC,wEAUA,SAAAM,EAAmDtD,EAAnDuD,GAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAxC,EAAAyC,EAAAC,EAAAC,EAAA,OAAAlE,EAAAC,EAAAC,KAAA,SAAAiE,GAAA,cAAAA,EAAA/D,KAAA+D,EAAA9D,MAAA,UAA4DkD,EAA5DD,EAA4DC,OAA5DC,EAAAF,EAAoEG,WAApE,IAAAD,EAAwE,IAAxEA,EAA6EE,EAA7EJ,EAA6EI,IAAKC,EAAlFL,EAAkFK,MAAOC,EAAzFN,EAAyFM,OACxFC,EAAqB,SAACO,GAAD,OAAUA,EAAKC,QAAQ,kBAAmB,SAACC,EAAGC,GAAJ,kBAAAlC,OAAuBkC,EAAvB,SAC/DT,EAA0B,SAACU,GAC/B,IAAIhD,MAAMC,QAAQ+C,GAAM,MAAM,IAAI/E,EAAe,KACjD,IAAMgF,EAAaD,EAAIE,IAAI,SAAAC,GACzB,OAAKA,EAAIC,eAAe,YAAeD,EAAG,QAAH,MAAwBE,OACxDF,EAAG,QAAH,MAAwBD,IAAI,SAAAI,GAAK,OAAIA,EAAMC,KAAIC,MAAM,EAAG,GAAGtD,KAAK,IADO,KAE7EA,KAAK,KACR,IAAK+C,EAAY,MAAM,IAAIhF,EAAe,4CAC1C,MAAO,iBAAmBgF,GAEtBV,EAAyB,SAACS,GAC9B,IAAIhD,MAAMC,QAAQ+C,GAAM,MAAM,IAAI/E,EAAe,KACjD,IAAMwF,EAAWT,EAAIE,IAAI,SAAAC,GACvB,OAAKA,EAAIC,eAAe,WAAcD,EAAG,OAAH,MAAuBE,OACtDF,EAAG,OAAH,MAAuBD,IAAI,SAAAI,GAAK,OAAIA,EAAMC,KAAIC,MAAM,EAAG,GAAGtD,KAAK,IADM,KAE3EA,KAAK,KACR,IAAKuD,EAAU,MAAM,IAAIxF,EAAe,2CACxC,MAAO,gBAAkBwF,GAGV,6CACb1D,EAAoBzB,8CACpB0B,MAAMC,QAAQgC,IAAuB,IAAfA,EAAIoB,OAActD,GAAqB,aAAekC,EAAI,GAAK,cAAgBA,EAAI,GACxGlC,GAAqB,cAAgBkC,EAAM,IAAM,eAAiBA,EAAM,IAxBxEU,EAAA/D,KAAA,GA2BCuD,EA3BD,CAAAQ,EAAA9D,KAAA,gBAAA8D,EAAA9D,KAAA,GA4B4BsB,QAAQuD,KAAK1D,MAAMC,QAAQkC,GAASA,EAAQ,CAACA,IAAQe,IAAI,SAACN,GAAD,OAAU5B,EAAczC,EAAO8D,EAAmBO,GAAO,YA5B9I,QA4BKJ,EA5BLG,EAAAxD,KA6BDY,GAAqBwC,EAAuBC,GA7B3CG,EAAA9D,KAAA,qBA8BQuD,EA9BR,CAAAO,EAAA9D,KAAA,gBAAA8D,EAAA9D,KAAA,GA+B4BsB,QAAQuD,KAAK1D,MAAMC,QAAQmC,GAAUA,EAAS,CAACA,IAASc,IAAI,SAACN,GAAD,OAAU5B,EAAczC,EAAOqE,EAAM,aA/B7H,QA+BKJ,EA/BLG,EAAAxD,KAgCDY,GAAqBuC,EAAwBE,GAhC5CG,EAAA9D,KAAA,qBAiCQkD,EAjCR,CAAAY,EAAA9D,KAAA,SAkCDkB,GAAqB,iBAAmBC,MAAMC,QAAQ8B,GAAUA,EAAO7B,KAAK,KAAO6B,GAlClFY,EAAA9D,KAAA,wBAAA8D,EAAAvD,OAAA,SAoCMe,QAAQE,OAAO,qBApCrB,QAAAsC,EAAA9D,KAAA,oBAAA8D,EAAA/D,KAAA,GAAA+D,EAAAgB,GAAAhB,EAAA,SAuCmB,kBAAlBA,EAAAgB,IAAyC,MAAXhB,EAAAgB,GAvC/B,CAAAhB,EAAA9D,KAAA,gBAAA8D,EAAAvD,OAAA,SAuCsDe,QAAQE,OAAO,qBAvCrE,eAAAsC,EAAAvD,OAAA,SAwCSe,QAAQE,OAARsC,EAAAgB,KAxCT,eAAAhB,EAAA9D,KAAA,GA2CyBsB,QAAQuD,KAAMxB,EAAYlC,MAAMC,QAAQiC,GAAOA,EAAM,CAACA,GAAlC,IACjDgB,IADyC,eAAAU,EAAAC,OAAAC,EAAA,EAAAD,CAAArF,EAAAC,EAAAsF,KACrC,SAAAC,EAAMC,GAAN,IAAAC,EAAAtG,EAAAC,EAAA,OAAAW,EAAAC,EAAAC,KAAA,SAAAyF,GAAA,cAAAA,EAAAvF,KAAAuF,EAAAtF,MAAA,cACCqF,EAAmBnE,EAAoB,YAAc7D,EAA2B+H,GAAG,GAAK,YAAc/H,EAA2B+H,GAAG,GACxIC,GAAoB,aAAehI,EAA2B+H,GAAG,GAAK,aAAe/H,EAA2B+H,GAAG,GACnHtC,QAAQC,IAAIsC,GAHTC,EAAAtF,KAAA,EAIgBT,EAAwB8F,EAAkB3F,GAJ1D,cAIGX,EAJHuG,EAAAhF,KAAAgF,EAAAtF,KAAA,EAKgBjB,EAAKC,OALrB,cAKGA,EALHsG,EAAAhF,KAMHxB,EAAYC,EAAMC,GANfsG,EAAA/E,OAAA,SAOI,CAAE8C,IAAK+B,EAAGG,MAAOvG,IAPrB,yBAAAsG,EAAA9E,SAAA2E,MADqC,gBAAAK,GAAA,OAAAT,EAAAvC,MAAAnD,KAAAoD,YAAA,KA3CrC,eAAAqB,EAAA2B,GAqDG,SAAC7F,EAAG8F,GACV,OAAI9F,EAAE2E,eAAemB,EAAErC,KAAazD,GACpCA,EAAE8F,EAAErC,KAAOqC,EAAEH,MACN3F,IAxDJkE,EAAA6B,GAyDF,GAdC9B,EA3CCC,EAAAxD,KAqDJsF,OArDI9B,EAAA2B,GAAA3B,EAAA6B,IAAA7B,EAAAvD,OAAA,SA2DEsD,GA3DF,yBAAAC,EAAAtD,SAAAwC,EAAA,mGClFc6C,mLACV,IAAAC,EACuEzG,KAAK0G,MAA3EC,EADDF,EACCE,cAAeC,EADhBH,EACgBG,gBAAiBC,EADjCJ,EACiCI,SAAUC,EAD3CL,EAC2CK,iBAAkBC,EAD7DN,EAC6DM,MACpE,OACEC,EAAAzG,EAAA0G,cAACC,EAAA,EAAD,CAAaH,MAAOA,GAClBC,EAAAzG,EAAA0G,cAACE,EAAA,EAAD,CAAYC,QAAM,EAACC,QAAQ,QAAQN,MAAO,CAAEO,WAAY,WACtDN,EAAAzG,EAAA0G,cAAA,QAAMF,MAAO,CAAEQ,cAAe,QAA9B,SACAP,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAES,QAAS,UAAYC,QAAS,kBAAMX,MAAoBE,EAAAzG,EAAA0G,cAACS,EAAA,EAAD,CAASX,MAAO,CAAEY,OAAQ,SAAUC,KAAM,QAAUC,QAAQ,aAChIb,EAAAzG,EAAA0G,cAAA,QAAMa,EAAE,igCAGZd,EAAAzG,EAAA0G,cAACc,EAAA,EAAD,CACEhB,MAAO,CAAEiB,SAAU,GAAIC,KAAM,GAC7BC,UAAQ,EACRC,MAAOnB,EAAAzG,EAAA0G,cAACmB,EAAA,EAAD,CAAOC,KAAK,UACnBnC,MAAOS,EACPE,SAAU,SAACyB,GAAD,OAAOzB,EAASyB,EAAEC,OAAOrC,SAEjCU,GAAmBA,EAAgBzB,OAAS,EAC5CyB,EAAgB5B,IAAI,SAACwD,GAAD,OAAOxB,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUzE,IAAKwE,EAAGtC,MAAOsC,GAAIA,EAAE7D,QAAQ,KAAM,QAAoBqC,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,qCAnB7DC,IAAMC,sBCA3CC,mLAOK,IAAAnC,EAC0CzG,KAAK0G,MAA9CmC,EADDpC,EACCoC,QAASC,EADVrC,EACUqC,WAAYjC,EADtBJ,EACsBI,SAAUE,EADhCN,EACgCM,MACvC,OACEC,EAAAzG,EAAA0G,cAACC,EAAA,EAAD,CAAaH,MAAOA,GAClBC,EAAAzG,EAAA0G,cAACE,EAAA,EAAD,CAAYC,QAAM,EAACC,QAAQ,OAA3B,OAGAL,EAAAzG,EAAA0G,cAACc,EAAA,EAAD,CAAQI,MAAOnB,EAAAzG,EAAA0G,cAACmB,EAAA,EAAD,CAAOC,KAAK,QAAUA,KAAK,MAAMnC,MAAO4C,EAAYjC,SAAU,SAACyB,GAAD,OAAOzB,EAASyB,KAC3FtB,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUM,UAAQ,EAACC,UAAWH,EAAQI,OAAtC,cACCL,EAAYM,gBAAgBlE,IAAI,SAACwD,GAAD,OAAOxB,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUzE,IAAKwE,EAAGQ,UAAWH,EAAQM,KAAMjD,MAAOsC,GAAIA,KAC9FxB,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUM,UAAQ,EAACC,UAAWH,EAAQI,OAAtC,cACCL,EAAYQ,gBAAgBpE,IAAI,SAACwD,GAAD,OAAOxB,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUzE,IAAKwE,EAAGQ,UAAWH,EAAQM,KAAMjD,MAAOsC,GAAIA,cAlB9EE,IAAMC,eAA1BC,EACGM,gBAAkB,CACvB,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,OAFlEN,EAIGQ,gBAAkB,CACvB,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,MAAO,OAoBxE,IAqBeC,cArBA,SAACC,GAAD,MAAY,CACzBH,KAAM,CACJI,YAAaD,EAAME,QAAQ,IAE7BP,MAAO,CACLQ,WAAYH,EAAMI,WAAWC,iBAC7BC,QAAS,GAEXnB,SAAU,CACRc,YAAaD,EAAME,QAAQ,IAE7BK,UAAW,CACTJ,WAAYH,EAAMI,WAAWC,iBAC7BC,QAAS,EACTE,OAAQ,UACRC,UAAW,CACTC,gBAAiB,6BAKRX,CAAmBT,6BC5CnB,SAASqB,EAATrG,GAAgF,IAA3DsG,EAA2DtG,EAA3DsG,IAAKC,EAAsDvG,EAAtDuG,IAAKxC,EAAiD/D,EAAjD+D,OAAQyC,EAAyCxG,EAAzCwG,YAAaC,EAA4BzG,EAA5ByG,YAAaC,EAAe1G,EAAf0G,YAC9E,OACEtD,EAAAzG,EAAA0G,cAAA,WACED,EAAAzG,EAAA0G,cAACE,EAAA,EAAD,CAAYJ,MAAO,CAAEwD,MAAO,QAAUnD,QAAM,GAA5C,OACAJ,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAES,QAAS,OAAQG,OAAQA,IACrCX,EAAAzG,EAAA0G,cAACuD,EAAA,EAAD7E,OAAA8E,OAAA,GCRO,WAAqD,IAA/BC,EAA+BtH,UAAA+B,OAAA,QAAAwF,IAAAvH,UAAA,GAAAA,UAAA,GAApB,aAAUwH,EAAUxH,UAAA+B,OAAA,QAAAwF,IAAAvH,UAAA,GAAAA,UAAA,GAAL,IAAKyH,EACtBC,oBAAS,GADaC,EAAApF,OAAAqF,EAAA,EAAArF,CAAAkF,EAAA,GAC3DI,EAD2DF,EAAA,GAC3CG,EAD2CH,EAAA,GAgBlE,OAbAI,oBAAU,WACR,IAAIC,EAOJ,OANIH,EACFG,EAAUC,WAAWX,EAAUE,GAE/BU,aAAaF,GAGR,WACLE,aAAaF,KAEd,CAACV,EAAUE,EAAIK,IAEX,CACLM,YAAa,WAAiC,OAAzBL,GAAkB,IAAc,GACrDM,UAAW,WAAkC,OAA1BN,GAAkB,IAAe,GACpDO,aAAc,WAAkC,OAA1BP,GAAkB,IAAe,GACvDQ,aAAc,WAAiC,OAAzBR,GAAkB,IAAc,GACtDS,WAAY,WAAkC,OAA1BT,GAAkB,IAAe,IDZ3CU,CAAatB,EAAa,KADhC,CAEEuB,YAAY,WACZ3B,IAAKA,EAAKC,IAAKA,EACfjE,MAAOkE,EACPvD,SAAU,SAACyB,EAAGwD,GAAJ,OAAiBzB,EAAY/B,EAAGwD,IAC1CC,kBAAkB,yBEZtBC,EAAe,CACnBC,MAAS,sCACTC,OAAU,aACVC,MAAS,sBAGUC,mLACV,IAAA3F,EACiDzG,KAAK0G,MAArDK,EADDN,EACCM,MAAOxD,EADRkD,EACQlD,KAAM2C,EADdO,EACcP,MAAOW,EADrBJ,EACqBI,SAAUL,EAD/BC,EAC+BD,cAChC6F,EAActF,EAAMkB,KAAO,CAAEA,KAAMlB,EAAMkB,MAAS,CAAEqE,SAAUvF,EAAMuF,SAAUC,UAAWxF,EAAMwF,UAAWC,WAAYzF,EAAMyF,YAClI,OACExF,EAAAzG,EAAA0G,cAACC,EAAA,EAAD,CAAaH,MAAOA,GAClBC,EAAAzG,EAAA0G,cAACE,EAAA,EAAD,CAAYC,QAAM,EAACL,MAAO,CAAEO,WAAY,WAAxC,QAGAN,EAAAzG,EAAA0G,cAACc,EAAA,EAAD,CAAQ7B,MAAO3C,EAAMsD,SAAU,SAACyB,GAAD,OAAOzB,EAAS,CAAEtD,KAAM+E,EAAEC,OAAOrC,SAAUa,MAAO,CAAE0F,YAAa,IAC9FzF,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUvC,MAAM,SAAhB,SACAc,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUvC,MAAM,UAAhB,UACAc,EAAAzG,EAAA0G,cAACwB,EAAA,EAAD,CAAUvC,MAAM,SAAhB,UAGU,UAAT3C,EACDiD,EAEAQ,EAAAzG,EAAA0G,cAACyF,EAAA,EAAD,CACExG,MAAOA,EACPW,SAAU,SAACyB,GAAD,OAAOzB,EAAS,CAAE8F,MAAOrE,EAAEC,OAAOrC,SAC5Ca,MAAOsF,EACPO,YAAaZ,EAAazI,GAC1BsJ,gBAAiB,CAAEzF,QAAQ,EAAM0F,kBAAkB,GACnDC,MAAM,mBAxBqBrE,IAAMC,eAgC7CyD,EAAUY,aAAe,CACvBzJ,KAAM,qBCtBO0J,EAlBU,SAAArJ,GAAiC,IAA9BsJ,EAA8BtJ,EAA9BsJ,cAAeC,EAAevJ,EAAfuJ,SAAeC,EACnCC,cADmCC,EAAA3H,OAAAqF,EAAA,EAAArF,CAAAyH,EAAA,GACjDG,EADiDD,EAAA,GAC5C/C,EAD4C+C,EAAA,GAExD,OAAQtG,EAAAzG,EAAA0G,cAAA,OAAKsG,IAAKA,EAAKxG,MAAO,CAC5BwD,MAAO,OACP/C,QAAS,OACTgG,eAAgB,WAEhBxG,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CACVwD,MAAOkD,KAAKC,MAAMnD,EAAQ2C,GAAiBA,EAAgB,EAC3D1F,QAAS,OAAQmG,cAAe,MAChCH,eAAgB,aAAcI,WAAY,SAC1CC,SAAU,SAETV,aCbDW,EAAO,CACXC,EAAK,CAAC,GAAI,IACVC,EAAK,CAAC,GAAI,KAENhK,EAAM,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,KAAM,KAAM,IAAK,IAAK,KAEjEiK,EAAU,CACd1O,MAAO,iBACPtB,KAAO,gBACPE,KAAO,gBACPE,KAAO,gBACPE,KAAO,eACPE,KAAO,eACPE,KAAO,eACPE,KAAO,eACPE,KAAO,eACPE,KAAO,eACPE,MAAO,gBACPE,MAAO,iBACPG,MAAO,gBACPtB,KAAO,eACPE,KAAO,eACPE,KAAO,eACPE,KAAO,gBACPE,KAAO,gBACPE,KAAO,gBACPE,KAAO,eACPE,KAAO,eACPE,KAAO,eACPE,MAAO,gBACPE,MAAO,iBAGH4O,EAAuB,SAACC,GAC5B,IAAMC,EAASX,KAAKtD,IAAI,EAAGnG,EAAIqK,QAAQF,EAAW7I,MAAM,GAAI,MAAQ,IAAItB,EAAImB,QACtEmJ,EAAyBR,EAAKK,EAAW7I,OAAO,IACtD,aAAA3C,OAAcyL,EAAd,MAAAzL,OAAyB2L,EAAuB,GAAhD,OAAA3L,OAAwD2L,EAAuB,GAA/E,OAGIC,EAA2B,SAACJ,GAChC,IAAMC,EAASX,KAAKtD,IAAI,EAAGnG,EAAIqK,QAAQF,EAAW7I,MAAM,GAAI,MAAQ,IAAItB,EAAImB,QACtEmJ,EAAyBR,EAAKK,EAAW7I,OAAO,IACtD,aAAA3C,OAAcyL,EAAd,MAAAzL,OAAyB2L,EAAuB,GAAhD,OAAA3L,OAAoF,GAA5B2L,EAAuB,GAA/E,OAiBa,SAASE,EAAT5K,GAA2B,IAAR6K,EAAQ7K,EAAR6K,KAYhC,OAXqB9I,OAAO+I,KAAKD,GAAMlI,OAAO,SAACoI,EAAaC,GAC1D,IAhBgBC,EAgBVC,IAhBUD,EAgBYJ,EAAKG,MAffC,EAAWE,QAAUF,EAAWE,OAAO5J,OAAS,EAAU6B,EAAAzG,EAAA0G,cAAA,YACvE4H,EAAWE,OACVC,KAAK,SAACzO,EAAG8F,GAAJ,OAAUA,EAAE4I,WAAa1O,EAAE0O,aAChCjK,IAAI,SAACI,GAAD,OACH4B,EAAAzG,EAAA0G,cAAA,OAAKjD,IAAKoB,EAAMC,GAAI0B,MAAO,CAAEmI,gBAAe,OAAAvM,OAASyC,EAAM+J,MAAQ/J,EAAM+J,MAAMC,OAAO,GAAGC,IAAM,GAAnD,KAA0DC,OAAQ,EAAGtF,gBAAiB,OAAQuF,OAAQ,iBAAkBC,UAAW,gBAC7KxI,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAEuI,OAAQ,EAAGC,OAAQ,mBAAoBvF,gBAAiB,qBAAsByF,aAAc,MAAO9H,OAAQ,IAAK4C,MAAO,IAAK/C,QAAS,OAAQmG,cAAe,SAAUC,WAAY,SAAUJ,eAAgB,WACxNxG,EAAAzG,EAAA0G,cAAA,MAAI+B,UAAU,eAAe5D,EAAMsK,QAAQ1K,IAAI,SAAC2K,EAAKC,GAAN,OAAY5I,EAAAzG,EAAA0G,cAAA,KAAG+B,UAAU,cAAchF,IAAK2L,EAAItK,GAAK,GAAKuK,EAAGC,KAAMF,EAAIG,cAAcC,SAAUJ,EAAItH,QAAW9B,OAAOyJ,GAAY,KAChLhJ,EAAAzG,EAAA0G,cAAA,MAAI+B,UAAU,aAAYhC,EAAAzG,EAAA0G,cAAA,KAAG+B,UAAU,YAAY6G,KAAMzK,EAAM0K,cAAcC,SAAU3K,EAAMiD,WAgBxG,OAPIyG,EAAS3J,QACXwJ,EAAYsB,KAAZ9M,MAAAwL,EAAW,CAAM3H,EAAAzG,EAAA0G,cAAA,OAAKjD,IAAK4K,EAAY7H,MAAO,CAAEuI,OAAQ,EAAGtF,gBAAiBkE,EAAqBU,GAAarE,MAAO,OAAQ2F,MAAO3B,EAAyBK,GAAaY,UAAW,gBACnLxI,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAEuI,OAAQ,EAAG9H,QAAS,OAAQmG,cAAe,SAAUC,WAAY,SAAUJ,eAAgB,WACvGxG,EAAAzG,EAAA0G,cAAA,MAAIF,MAAO,CAAEoJ,SAAU,MAAOb,OAAQ,IAAMrB,EAAQW,OAF7CjM,OAAAgD,OAAAyK,EAAA,EAAAzK,CAIAmJ,KAENH,GACN,kBCtEU,SAAS0B,GAATzM,GAAiD,IAAxBvB,EAAwBuB,EAAxBvB,KAAMxC,EAAkB+D,EAAlB/D,MAAOyQ,EAAW1M,EAAX0M,QACnD,OAAQtJ,EAAAzG,EAAA0G,cAACsJ,GAAA,EAAD,CAAUC,aAAc,CAC9BC,SAAU,SACVC,WAAY,QACXrO,KAAMA,EAAMiO,QAASA,EAASK,iBAAkB,IAAMC,aAAc,CACrEC,mBAAoB,cACnB/Q,QAASkH,EAAAzG,EAAA0G,cAAA,QAAM5B,GAAG,cAAT,UAA8BxF,EAA9B,OCId,IAasBU,GAAG8F,GAbnByK,GAAY,SAACC,EAAQC,GAAT,OAAqBD,GAAUC,EAAU,IAAM,MAE3DC,GAAgB,IAChBC,GAAkB,EAClBC,IAAuB,EAGhBnB,GAAa,SAACzP,EAAG8F,GAG5B,OAFiB,IAAb9F,EAAE4E,OAAc5E,EAAE0P,KAAK5J,GACtB9F,EAAE0P,KAAKjJ,EAAAzG,EAAA0G,cAAA,MAAIjD,IAAKzD,EAAE4E,OAAO,IAAMkB,GAC7B9F,GAUH6Q,IAPgB7Q,GAOQ,EAPL8F,GAOQ,GAPF,SAAC3F,EAAM2Q,GAIpC,OAHAA,EAAS3Q,EAAO2Q,GAChBA,GAAWhL,GAAI9F,GAAI,GACNA,KAAG8Q,GAAUhL,IACnBgL,IA2JMC,eArJb,SAAAA,IAAc,IAAAC,EAAA,OAAA5L,OAAA6L,EAAA,EAAA7L,CAAA3F,KAAAsR,IACZC,EAAA5L,OAAA8L,EAAA,EAAA9L,CAAA3F,KAAA2F,OAAA+L,EAAA,EAAA/L,CAAA2L,GAAAK,KAAA3R,QACKwC,MAAQ,CACXuO,OAAQG,GACRF,QAASG,GACT9Q,MAAOoB,OAAOmQ,aAAaC,QAAQ,SACnCtP,QAASd,OAAOmQ,aAAaC,QAAQ,WACrCjL,gBAAiB,CAAC,UAAW,YAAa,OAAQ,MAAO,QAAS,SAClEkL,QAAS,kBACT1H,YAAa6G,GAEb1N,KAAM,QACNoJ,MAAO,IAZG4E,mFAmBV,IAAIQ,EAAcC,IAAYC,MAAMxQ,OAAOyQ,SAASC,MACpD,GAAKJ,EAAL,CAFF,IAGQK,EAAoCL,EAApCK,aAAcC,EAAsBN,EAAtBM,WAAY7P,EAAUuP,EAAVvP,MAChC,GAAIf,OAAO6Q,QAAU7Q,OAAO6Q,OAAOhQ,gBACjCb,OAAO6Q,OAAOhQ,gBAAgB8P,EAAcC,EAAY7P,QACnD,GAAI4P,GAAgBC,EAAY,CACrC,IAAIE,GAAU,IAAIC,MAAOC,UAAoC,IAAvBhQ,SAAS4P,GAAqB,GACpErS,KAAK0S,YAAYN,EAAcG,GAEjC9Q,OAAOkR,QAAQC,aAAa,KAAM,KAAM,0CAKhCvS,EAAOkC,GACbd,OAAOmQ,aAAaC,QAAQ,WAAaxR,IAG3CoB,OAAOmQ,aAAaiB,QAAQ,QAASxS,GACrCoB,OAAOmQ,aAAaiB,QAAQ,UAAWtQ,GACvCvC,KAAK8S,SAAS,CAAEzS,MAAOA,EAAOkC,QAASA,wCAIhC,IAAAwQ,EAAA/S,KACToB,EAAoB,mCA9DR,yCA8DqD4R,KAAK,SAAApP,GAAwB,IAArBvD,EAAqBuD,EAArBvD,MAAOkC,EAAcqB,EAAdrB,QAC9EwQ,EAAKL,YAAYrS,EAAOkC,oCAIrB+F,GACL,IAxEiB2K,EAwEXC,GAxEWD,EAwEO3K,EAAEC,OAAOrC,MAxER,CAAEzD,SAASwQ,EAAI3N,MAAM,GAAI,IAAsC,MAAhC2N,EAAI3N,OAAO,GAAG6N,gBAyEtEnT,KAAK8S,SAAS,CAAE/B,OAAQmC,EAAI,GAAKA,EAAI,GAAKhC,GAAiBF,QAASkC,EAAI,GAAKA,EAAI,GAAK/B,yCAG5E,IAAAiC,EAAApT,MTtBP,SAAPqT,GAAA,OAAAC,EAAAnQ,MAAAnD,KAAAoD,YSuBImQ,CAAUvT,KAAKwC,MAAMnC,OACpB2S,KAAK,SAAAxK,GAAC,OAAI4K,EAAKN,SAAS,CAAElM,gBAAiB4B,EAAE3E,WAC7C2P,MAAM,SAACC,GAEO,MAATA,EAAcL,EAAKM,WAClBN,EAAKN,SAAS,CAAEjT,MAAO,GAAG4T,4CAIrB,IAAAE,EAAA3T,KAAA4T,EACiD5T,KAAKwC,MAA1DnC,EADIuT,EACJvT,MAAO+J,EADHwJ,EACGxJ,YAAa2G,EADhB6C,EACgB7C,OAAQC,EADxB4C,EACwB5C,QAASzN,EADjCqQ,EACiCrQ,KAAMoJ,EADvCiH,EACuCjH,MAE/CkH,EAAS,GACA,UAATtQ,GAAoBoJ,GAASA,EAAMxH,QAAUwH,EAAMxH,OAAS,IAAG0O,GAAU,0CACzEA,EAAU7T,KAAK8S,SAAS,CAAEjT,MAAOgU,ITpBlC,SAAPC,EAAAC,GAAA,OAAAC,EAAA7Q,MAAAnD,KAAAoD,WSsBI6Q,CAAoC5T,EAAO,CACzCwD,OAAkB,UAATN,EAAmBoJ,EAAQ,KACpC5I,IAAKqG,EACLpG,IAAK,CAAC8M,GAAUC,EAAQC,GAAUF,GAAUM,GAASL,GAAS,GAAIC,GAAUF,GAAUM,GAASL,EAAQ,GAAIC,GAAUF,GAAUC,GAASC,IACxI/M,MAAiB,UAATV,EAAmBoJ,EAAMuH,MAAM,KAAKlP,IAAI,SAAAwD,GAAC,OAAIA,EAAE2L,SAAU,KACjEjQ,OAAkB,WAATX,EAAoBoJ,EAAMuH,MAAM,KAAKlP,IAAI,SAAAwD,GAAC,OAAIA,EAAE2L,SAAU,OAEpEnB,KAAK,SAAAxK,GAAC,OAAImL,EAAKb,SAAS,CAAEhB,QAAStJ,MACnCgL,MAAM,SAACC,GAEO,MAATA,EAAcE,EAAKD,WAClBC,EAAKb,SAAS,CAAEjT,MAAO,GAAG4T,8CAInBnL,EAAGwD,GACbxD,EAAE8L,UAA8C,kBAA3BpU,KAAKwC,MAAM4H,YAA0B0B,EAAW,CAAC9L,KAAKwC,MAAM4H,YAAa0B,GACzFhK,MAAMC,QAAQ+J,IAAaA,EAAS,KAAOA,EAAS,KAAIA,EAAWA,EAAS,IACrF9L,KAAK8S,SAAS,CAAE1I,YAAa0B,8CAGC,IAAfa,EAAejH,EAAfiH,MAAOpJ,EAAQmC,EAARnC,KAClBA,EACFvD,KAAK8S,SAAS,CAAEvP,OAAMoJ,MAAO,KAE7B3M,KAAK8S,SAAS,CAAEnG,2CAIX,IAAA0H,EAAArU,KAAAsU,EACuFtU,KAAKwC,MAA3FuO,EADDuD,EACCvD,OAAQC,EADTsD,EACStD,QAAS3Q,EADlBiU,EACkBjU,MAAOyR,EADzBwC,EACyBxC,QAASlL,EADlC0N,EACkC1N,gBAAiBwD,EADnDkK,EACmDlK,YAAa7G,EADhE+Q,EACgE/Q,KAAMoJ,EADtE2H,EACsE3H,MAAO9M,EAD7EyU,EAC6EzU,MACpF,OAAKQ,EAEH2G,EAAAzG,EAAA0G,cAAA,OAAK+B,UAAU,OACbhC,EAAAzG,EAAA0G,cAACoJ,GAAD,CAAehO,OAAQxC,EAAOA,MAAOA,EAAOyQ,QAAS,kBAAM+D,EAAKvB,SAAS,CAAEjT,MAAO,UAClFmH,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAEiD,gBAAiB,OAAQuK,QAAS,GAAI/E,UAAW,aAAchI,QAAS,cAAe+C,MAAO,QAASiD,eAAgB,SAAUK,SAAU,SACvJ7G,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAES,QAAS,OAAQmG,cAAe,SAAUpD,MAAO,MAAOtC,KAAM,WAAYuM,SAAU,SAChGxN,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAES,QAAS,SACrBR,EAAAzG,EAAA0G,cAACwN,EAAD,CAAa1N,MAAO,CAAE4G,cAAe,MAAO1F,KAAM,WAAY2F,WAAY,UAAY9E,WAAYgI,GAAUC,EAAQC,GAAUnK,SAAU,SAACyB,GAAD,OAAO+L,EAAKK,OAAOpM,MAC3JtB,EAAAzG,EAAA0G,cAAC0N,EAAD,CAAW5N,MAAO,CAAE4G,cAAe,MAAO1F,KAAM,YAAaD,SAAU,QAAS4F,WAAY,SAAUgH,WAAY,GACvGrR,KAAMA,EACN2C,MAAOyG,EACP9F,SAAU,SAACyB,GAAD,OAAO+L,EAAKQ,eAAevM,IACrC9B,cAAeQ,EAAAzG,EAAA0G,cAAC6N,EAAD,CACC/N,MAAO,CAAE4G,cAAe,MAAO1F,KAAM,WAAY2F,WAAY,SAAUgH,WAAY,GACnFjO,cAAwB,UAATpD,GAAoBzB,MAAMC,QAAQ4K,GAASA,EAAQ,GAAI/F,gBAAiBA,EACvFC,SAAU,SAACqM,GAAD,OAAUA,EAAI/N,QAAU,GAAMkP,EAAKvB,SAAS,CAAEnG,MAAOuG,KAC/DpM,iBAAkB,kBAAMuN,EAAKd,kBAI1DvM,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAEgO,UAAW,IACvB/N,EAAAzG,EAAA0G,cAAC+N,EAAA,EAAD,CAAQjO,MAAO,CAAEwD,MAAO,QAAU2F,MAAM,UAAU+E,QAAQ,YAAYxN,QAAS,kBAAM4M,EAAKa,gBAA1F,kBAGJlO,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAEkB,KAAM,aAClBjB,EAAAzG,EAAA0G,cAACgD,EAAD,CAAWK,YAAa,iBAAO,iBAAkB6K,SAASC,iBAAoBf,EAAKgB,gBAAgB,GAAI,CAAC,GAAI,OAAOjL,YAAaA,EAAaC,YAAa,SAAC/B,EAAGwD,GAAJ,OAAiBuI,EAAKgB,gBAAgB/M,EAAGwD,IAAWnE,OAAQ,GAAIuC,IAAK,EAAGC,IAAK,QAG3OnD,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAEgO,UAAW,IAAzB,+BAC8B/N,EAAAzG,EAAA0G,cAAA,QAAMF,MAAO,IAAMxD,EAAK4P,cAAxB,KAC5BnM,EAAAzG,EAAA0G,cAAA,QAAMF,MAAO,CAAEmJ,MAAO,QACnBvD,EAAS,UAAY7K,MAAMC,QAAQ4K,GAASA,EAAM3K,KAAK,MAAQ2K,GAAU,GACxE7K,MAAMC,QAAQqI,IAAuC,IAAvBA,EAAYjF,OAA1C,6BAAAxC,OAAsFyH,EAAY,GAAlG,QAAAzH,OAA2GyH,EAAY,GAAvH,QACuB,kBAAhBA,EAAP,oBAAAzH,OAAsDyH,EAAtD,mBAAkF,KAIxFpD,EAAAzG,EAAA0G,cAAA,OAAKF,MAAO,CAAEwN,QAAS,SAAU/M,QAAS,OAAQgG,eAAgB,WAChExG,EAAAzG,EAAA0G,cAACqO,EAAD,CAAkBpI,cAAe,KAC/BlG,EAAAzG,EAAA0G,cAACuH,EAAD,CAASC,KAAMqD,OAvCJ9K,EAAAzG,EAAA0G,cAAA,OAAK+B,UAAU,MAAMjC,MAAO,CAAES,QAAS,OAAQgG,eAAgB,SAAUI,WAAY,WAAY5G,EAAAzG,EAAA0G,cAAC+N,EAAA,EAAD,CAAQvN,QAAS,kBAAM4M,EAAKX,aAA5B,4CAvGtGhL,IAAM6M,WCvBlBC,GAAcC,QACW,cAA7BhU,OAAOyQ,SAASwD,UAEe,UAA7BjU,OAAOyQ,SAASwD,UAEhBjU,OAAOyQ,SAASwD,SAASC,MACvB,2DAsCN,SAASC,GAAgBC,EAAOC,GAC9BC,UAAUC,cACPC,SAASJ,GACT7C,KAAK,SAAAkD,GACJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiB5T,QACfuT,UAAUC,cAAcO,YAI1B9S,QAAQC,IACN,iHAKEoS,GAAUA,EAAOU,UACnBV,EAAOU,SAASN,KAMlBzS,QAAQC,IAAI,sCAGRoS,GAAUA,EAAOW,WACnBX,EAAOW,UAAUP,UAO5B1C,MAAM,SAAA3T,GACL4D,QAAQ5D,MAAM,4CAA6CA,KC1FjE6W,IAASC,OAAO3P,EAAAzG,EAAA0G,cAAC2P,GAAD,MAASzB,SAAS0B,eAAe,SDgB1C,SAAkBf,GACvB,GAA6C,kBAAmBC,UAAW,CAGzE,GADkB,IAAIe,IAAIC,iBAAwBtV,OAAOyQ,SAASrC,MACpDmH,SAAWvV,OAAOyQ,SAAS8E,OAIvC,OAGFvV,OAAOwV,iBAAiB,OAAQ,WAC9B,IAAMpB,EAAK,GAAAlT,OAAMoU,iBAAN,sBAEPvB,IAgEV,SAAiCK,EAAOC,GAEtClV,MAAMiV,GACH7C,KAAK,SAAAkE,GAEJ,IAAMC,EAAcD,EAASrW,QAAQuW,IAAI,gBAEnB,MAApBF,EAAStX,QACO,MAAfuX,IAA8D,IAAvCA,EAAY9I,QAAQ,cAG5C0H,UAAUC,cAAcqB,MAAMrE,KAAK,SAAAkD,GACjCA,EAAaoB,aAAatE,KAAK,WAC7BvR,OAAOyQ,SAASqF,aAKpB3B,GAAgBC,EAAOC,KAG1BtC,MAAM,WACL/P,QAAQC,IACN,mEArFA8T,CAAwB3B,EAAOC,GAI/BC,UAAUC,cAAcqB,MAAMrE,KAAK,WACjCvP,QAAQC,IACN,gHAMJkS,GAAgBC,EAAOC,MCvC/BE","file":"static/js/main.fe7b38b8.chunk.js","sourcesContent":["const CamelotKeyToIntegerAndMode = {\n  \"1A\":  [8,  0],   \"1B\":  [8,  1],\n  \"2A\":  [3,  0],   \"2B\":  [3,  1],\n  \"3A\":  [10, 0],   \"3B\":  [10, 1],\n  \"4A\":  [5,  0],   \"4B\":  [5,  1],\n  \"5A\":  [0,  0],   \"5B\":  [0,  1],\n  \"6A\":  [7,  0],   \"6B\":  [7,  1],\n  \"7A\":  [2,  0],   \"7B\":  [2,  1],\n  \"8A\":  [9,  0],   \"8B\":  [9,  1],\n  \"9A\":  [4,  0],   \"9B\":  [4,  1],\n  \"10A\": [11, 0],   \"10B\": [11, 1],\n  \"11A\": [6,  0],   \"11B\": [6,  1],\n  \"12A\": [1,  0],   \"12B\": [1,  1],\n}\n\nfunction secureMathRandom() {\n  // Divide a random UInt32 by the maximum value (2^32 -1) to get a result between 0 and 1\n  return window.crypto.getRandomValues(new Uint32Array(1))[0] // 4294967295;\n}\n\nfunction handleError(resp, json) {\n  if (resp.status === 401) throw resp.status\n  if (resp.status !== 200) {\n    if (json && json.error && json.error.message) throw json.error.message\n    throw resp.status\n  }\n}\n\nclass FetchException extends Error {\n  toString() {\n    return this.message\n  }\n}\n\nasync function fetchJSONWithOAuthToken(endpoint, token) {\n  const resp = await fetch(endpoint, {\n    headers: {\n      \"Accept\": \"application/json\",\n      \"Content-Type\": \"application/json\",\n      \"Authorization\": \"Bearer \" + token\n    }\n  })\n  return resp;\n}\n\nexport function getTokenInNewWindow(client_id, redirect_url, scopes) {\n  const endpoint = \"https://accounts.spotify.com/authorize\"\n  let nonce = secureMathRandom();\n  let callable_endpoint = endpoint + \"?response_type=token\"\n  callable_endpoint += \"&redirect_uri=\" + redirect_url\n  callable_endpoint += \"&client_id=\" + client_id\n  if (scopes) callable_endpoint += \"&scopes=\" + (Array.isArray(scopes) ? scopes.join(' ') : scopes)\n  callable_endpoint += \"&state=\" + nonce\n\n  return new Promise((resolve, reject) => {\n    let popup = window.open(callable_endpoint, 'Login with Spotify', 'width=800,height=600')\n    window.spotifyCallback = (token, expires, state) => {\n      state = parseInt(state)\n      popup.close()\n      if (state !== nonce) {\n        reject(`Nonce is invalid, expected: ${nonce} but got ${state}`)\n      } else {\n        resolve({ token: token, expires: expires })\n      }\n    }\n  })\n}\n\nexport async function getGenres(token) {\n  const endpoint = \"https://api.spotify.com/v1/recommendations/available-genre-seeds\"\n  const resp = await fetchJSONWithOAuthToken(endpoint, token)\n  if (resp.status !== 200) return Promise.reject()\n  return await resp.json()\n}\n\nexport async function searchSpotify(token, searchTerm, type) {\n  if (!searchTerm) return Promise.reject(\"No search terms provided\")\n  const endpoint = \"https://api.spotify.com/v1/search?q=\" + searchTerm + \"&type=\" + type\n  console.log(endpoint)\n  const resp = await fetchJSONWithOAuthToken(endpoint, token)\n  const json = await resp.json()\n  handleError(resp, json)\n  return json\n}\n\nexport async function getRecommendationsBasedOnAttributes(token, { genres, bpm=120, key, songs, artist }) {\n  const replaceSongArtists = (term) => term.replace(/\\s*\\((.*)\\)\\s*/g, (m, p1) => ` artist:\"${p1}\" `)\n  const extractArtistToEndpoint = (arr) => {\n    if(!Array.isArray(arr)) throw new FetchException(400)\n    const artistsIds = arr.map(obj => {\n      if (!obj.hasOwnProperty(\"artists\") || !obj[\"artists\"][\"items\"].length) return \"\";\n      return obj[\"artists\"][\"items\"].map(track => track.id).slice(0, 1).join('')\n    }).join(',');\n    if (!artistsIds) throw new FetchException(\"No artists found using your search terms\")\n    return \"&seed_artists=\" + artistsIds\n  }\n  const extractTrackToEndpoint = (arr) => {\n    if(!Array.isArray(arr)) throw new FetchException(400)\n    const trackIds = arr.map(obj => {\n      if (!obj.hasOwnProperty(\"tracks\") || !obj[\"tracks\"][\"items\"].length) return \"\";\n      return obj[\"tracks\"][\"items\"].map(track => track.id).slice(0, 1).join('')\n    }).join(',')\n    if (!trackIds) throw new FetchException(\"No tracks found using your search terms\")\n    return \"&seed_tracks=\" + trackIds\n  }\n\n  const endpoint = \"https://api.spotify.com/v1/recommendations\"\n  let callable_endpoint = endpoint + '?'\n  if (Array.isArray(bpm) && bpm.length === 2) callable_endpoint += \"min_tempo=\" + bpm[0] + \"&max_tempo=\" + bpm[1]\n  else callable_endpoint += \"min_tempo=\" + (bpm - 10) + \"&max_tempo=\" + (bpm + 10)\n  \n  try {\n    if (songs) {\n      const searchResponse = await Promise.all((Array.isArray(songs) ? songs : [songs]).map((term) => searchSpotify(token, replaceSongArtists(term), \"track\")))\n      callable_endpoint += extractTrackToEndpoint(searchResponse)\n    } else if (artist) {\n      const searchResponse = await Promise.all((Array.isArray(artist) ? artist : [artist]).map((term) => searchSpotify(token, term, \"artist\")))\n      callable_endpoint += extractArtistToEndpoint(searchResponse)\n    } else if (genres) {\n      callable_endpoint += \"&seed_genres=\" + (Array.isArray(genres) ? genres.join(',') : genres)\n    } else {\n      return Promise.reject(\"No search terms!\")\n    }\n  } catch (status) {\n    if (typeof status === 'number' && status === 400) return Promise.reject(\"Server fucked up\");\n    else return Promise.reject(status)\n  }\n  \n  let mapped_responses = (await Promise.all((!key ? [] : (Array.isArray(key) ? key : [key]))\n  .map(async k => {\n    let modifiedEndpoint = callable_endpoint + \"&min_key=\" + CamelotKeyToIntegerAndMode[k][0] + \"&max_key=\" + CamelotKeyToIntegerAndMode[k][0]\n    modifiedEndpoint += \"&min_mode=\" + CamelotKeyToIntegerAndMode[k][1] + \"&max_mode=\" + CamelotKeyToIntegerAndMode[k][1]\n    console.log(modifiedEndpoint)\n    const resp = await fetchJSONWithOAuthToken(modifiedEndpoint, token);\n    const json = await resp.json();\n    handleError(resp, json);\n    return { key: k, value: json };\n  })))\n  .reduce((a, b) => {\n    if (a.hasOwnProperty(b.key)) return a;\n    a[b.key] = b.value\n    return a;\n  }, {});\n\n  return mapped_responses\n}","import React from 'react';\nimport { Select, MenuItem, FormControl, InputLabel, Input, SvgIcon } from '@material-ui/core';\n\nexport default class GenreSelector extends React.PureComponent {\n  render() {\n    const { selectedGenre, availableGenres, onChange, onRefreshClicked, style } = this.props;\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink htmlFor=\"genre\" style={{ whiteSpace: 'nowrap' }}>\n          <span style={{ verticalAlign: 'top' }}>Genre</span>\n          <div style={{ display: 'inline' }} onClick={() => onRefreshClicked()}><SvgIcon style={{ height: '0.9rem', fill: '#393' }} viewBox=\"0 0 24 24\">\n            <path d=\"M 9 3 C 8.448 3 8 3.448 8 4 C 8 4.552 8.448 5 9 5 L 18 5 C 18.552 5 19 5.448 19 6 L 19 15 L 17 15 C 16.596 15 16.231172 15.243188 16.076172 15.617188 C 16.025172 15.741187 16 15.871 16 16 C 16 16.26 16.101969 16.516031 16.292969 16.707031 L 19.292969 19.707031 C 19.683969 20.098031 20.317031 20.098031 20.707031 19.707031 L 23.707031 16.707031 C 23.993031 16.421031 24.077828 15.992188 23.923828 15.617188 C 23.768828 15.243187 23.404 15 23 15 L 21 15 L 21 6 C 21 4.343 19.657 3 18 3 L 9 3 z M 4 4 C 3.744125 4 3.4879687 4.0974687 3.2929688 4.2929688 L 0.29296875 7.2929688 C 0.00696875 7.5789687 -0.077828125 8.0078125 0.076171875 8.3828125 C 0.23117187 8.7568125 0.596 9 1 9 L 3 9 L 3 18 C 3 19.657 4.343 21 6 21 L 15 21 C 15.552 21 16 20.552 16 20 C 16 19.448 15.552 19 15 19 L 6 19 C 5.448 19 5 18.552 5 18 L 5 9 L 7 9 C 7.404 9 7.7688281 8.7568125 7.9238281 8.3828125 C 7.9748281 8.2588125 8 8.129 8 8 C 8 7.74 7.8980312 7.4839687 7.7070312 7.2929688 L 4.7070312 4.2929688 C 4.5115312 4.0974687 4.255875 4 4 4 z\"/>\n          </SvgIcon></div>\n        </InputLabel>\n        <Select\n          style={{ minWidth: 70, flex: 1 }}\n          multiple\n          input={<Input name=\"genre\" />}\n          value={selectedGenre}\n          onChange={(e) => onChange(e.target.value)}\n        >\n          {(availableGenres && availableGenres.length > 0 ?\n            availableGenres.map((x) => <MenuItem key={x} value={x}>{x.replace(/-/g, ' ')}</MenuItem>) : <MenuItem>No genres available</MenuItem>)}\n        </Select>\n      </FormControl>\n    );\n  }\n}\n","import React from 'react';\nimport { withStyles, Select, MenuItem, FormControl, InputLabel, Input } from '@material-ui/core';\n\nclass KeySelector extends React.PureComponent {\n  static camelotMinorKey = [\n    \"1A\", \"2A\", \"3A\", \"4A\", \"5A\", \"6A\", \"7A\", \"8A\", \"9A\", \"10A\", \"11A\", \"12A\",\n  ];\n  static camelotMajorKey = [\n    \"1B\", \"2B\", \"3B\", \"4B\", \"5B\", \"6B\", \"7B\", \"8B\", \"9B\", \"10B\", \"11B\", \"12B\",\n  ];\n  render() {\n    const { classes, camelotKey, onChange, style } = this.props;\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink htmlFor=\"key\">\n          Key\n        </InputLabel>\n        <Select input={<Input name=\"key\" />} name=\"key\" value={camelotKey} onChange={(e) => onChange(e)}>\n          <MenuItem disabled className={classes.group}>Minor keys</MenuItem>\n          {KeySelector.camelotMinorKey.map((x) => <MenuItem key={x} className={classes.item} value={x}>{x}</MenuItem>)}\n          <MenuItem disabled className={classes.group}>Major keys</MenuItem>\n          {KeySelector.camelotMajorKey.map((x) => <MenuItem key={x} className={classes.item} value={x}>{x}</MenuItem>)}\n        </Select>\n      </FormControl>\n    );\n  }\n}\n\nconst styles = (theme) => ({\n  item: {\n    paddingLeft: theme.spacing(3),\n  },\n  group: {\n    fontWeight: theme.typography.fontWeightMedium,\n    opacity: 1,\n  },\n  MenuItem: {\n    paddingLeft: theme.spacing(3)\n  },\n  MenuGroup: {\n    fontWeight: theme.typography.fontWeightMedium,\n    opacity: 1,\n    cursor: \"default\",\n    \"&:hover\": {\n      backgroundColor: \"transparent !important\"\n    }\n  }\n})\n\nexport default withStyles(styles)(KeySelector)","import React from 'react';\nimport { InputLabel } from '@material-ui/core';\nimport { Slider } from '@material-ui/lab';\nimport useLongPress from './LongPress';\n\nexport default function BPMSlider({ min, max, height, selectedBpm, onBpmChange, onLongPress }) {\n  return (\n    <div>\n      <InputLabel style={{ width: '100%' }} shrink>BPM</InputLabel>\n      <div style={{ display: 'flex', height: height }}>\n        <Slider\n          {...useLongPress(onLongPress, 500)}\n          orientation=\"vertical\"\n          min={min} max={max}\n          value={selectedBpm}\n          onChange={(e, newValue) => onBpmChange(e, newValue)}\n          valueLabelDisplay=\"auto\"\n        />\n      </div>\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\n\nexport default function useLongPress(callback = () => {}, ms = 300) {\n  const [startLongPress, setStartLongPress] = useState(false);\n\n  useEffect(() => {\n    let timerId;\n    if (startLongPress) {\n      timerId = setTimeout(callback, ms);\n    } else {\n      clearTimeout(timerId);\n    }\n\n    return () => {\n      clearTimeout(timerId);\n    };\n  }, [callback, ms, startLongPress]);\n\n  return {\n    onMouseDown: () => { setStartLongPress(true); return true; },\n    onMouseUp: () => { setStartLongPress(false); return true; },\n    onMouseLeave: () => { setStartLongPress(false); return true; },\n    onTouchStart: () => { setStartLongPress(true); return true; },\n    onTouchEnd: () => { setStartLongPress(false); return true; },\n  };\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { FormControl, TextField, Select, MenuItem, InputLabel } from '@material-ui/core';\n\nconst placeholders = {\n  \"Track\": \"Never Gonna Give You Up, Robot Rock\",\n  \"Artist\": \"Kanye West\",\n  \"Genre\": \"Pop, Rock, Country\"\n}\n\nexport default class SearchBar extends React.PureComponent {\n  render() {\n    const { style, type, value, onChange, GenreSelector } = this.props;\n    const flexSizing = (style.flex ? { flex: style.flex } : { flexGrow: style.flexGrow, flexBasis: style.flexBasis, flexShrink: style.flexShrink })\n    return (\n      <FormControl style={style}>\n        <InputLabel shrink style={{ whiteSpace: 'nowrap' }}>\n          Type\n        </InputLabel>\n        <Select value={type} onChange={(e) => onChange({ type: e.target.value })} style={{ marginRight: 5 }}>\n          <MenuItem value=\"Track\">Track</MenuItem>\n          <MenuItem value=\"Artist\">Artist</MenuItem>\n          <MenuItem value=\"Genre\">Genre</MenuItem>\n        </Select>\n        {\n          (type === \"Genre\") ?\n          GenreSelector\n          :\n          <TextField\n            value={value}\n            onChange={(e) => onChange({ query: e.target.value })}\n            style={flexSizing}\n            placeholder={placeholders[type]}\n            InputLabelProps={{ shrink: true, disableAnimation: false }}\n            label=\"Search\"\n          />\n        }\n      </FormControl>\n    );\n  }\n}\n\nSearchBar.defaultProps = {\n  type: \"Track\"\n}\n\nSearchBar.propTypes = {\n  type: PropTypes.oneOf([\"Track\", \"Artist\", \"Genre\"])\n}","import React from 'react';\nimport useResizeObserver from \"use-resize-observer\";\n\nconst ResizableFlexbox = ({ childrenWidth, children }) => {\n  const [ref, width] = useResizeObserver();\n  return (<div ref={ref} style={{\n    width: '100%',\n    display: 'flex',\n    justifyContent: 'center'\n  }}>\n    <div style={{\n      width: Math.floor(width / childrenWidth) * childrenWidth + 1,\n      display: 'flex', flexDirection: 'row',\n      justifyContent: 'flex-start', alignItems: 'center',\n      flexWrap: 'wrap'\n    }}>\n      {children}\n    </div>\n  </div>);\n};\n\nexport default ResizableFlexbox;\n","import React from 'react';\nimport { spanJoiner } from './App';\n\nconst mode = {\n  \"A\": [80, 80],\n  \"B\": [90, 90],\n}\nconst key = [\"6\", \"5\", \"4\", \"3\", \"2\", \"1\", \"12\", \"11\", \"10\", \"9\", \"8\", \"7\"]\n\nconst keyText = {\n  \"12A\": \"12A - Db Minor\",\n  \"1A\":  \"1A - Ab Minor\",\n  \"2A\":  \"2A - Eb Minor\",\n  \"3A\":  \"3A - Bb Minor\",\n  \"4A\":  \"4A - F Minor\",\n  \"5A\":  \"5A - C Minor\",\n  \"6A\":  \"6A - G Minor\",\n  \"7A\":  \"7A - D Minor\",\n  \"8A\":  \"8A - A Minor\",\n  \"9A\":  \"9A - E Minor\",\n  \"10A\": \"10A - B Minor\",\n  \"11A\": \"11A - F# Minor\",\n  \"12B\": \"12B - E Major\",\n  \"1B\":  \"1B - B Major\",\n  \"2B\":  \"2B - F Major\",\n  \"3B\":  \"3B - D Major\",\n  \"4B\":  \"4B - Ab Major\",\n  \"5B\":  \"5B - Eb Major\",\n  \"6B\":  \"6B - Bb Major\",\n  \"7B\":  \"7B - F Major\",\n  \"8B\":  \"8B - C Major\",\n  \"9B\":  \"9B - G Major\",\n  \"10B\": \"10B - D Major\",\n  \"11B\": \"11B - A Major\",\n}\n\nconst GetCamelotWheelColor = (displayKey) => {\n  const keyHue = Math.max(0, key.indexOf(displayKey.slice(0, -1))) * (360/key.length)\n  const keySaturationValuePair = mode[displayKey.slice(-1)]\n  return `hsl(${keyHue}, ${keySaturationValuePair[0]}%, ${keySaturationValuePair[1]}%)`\n}\n\nconst GetCamelotWheelColorText = (displayKey) => {\n  const keyHue = Math.max(0, key.indexOf(displayKey.slice(0, -1))) * (360/key.length)\n  const keySaturationValuePair = mode[displayKey.slice(-1)]\n  return `hsl(${keyHue}, ${keySaturationValuePair[0]}%, ${keySaturationValuePair[1] * 0.3}%)`\n}\n\nfunction createDivs(result_obj) {\n  if (!result_obj || !result_obj.tracks || result_obj.tracks.length < 1) return <div />;\n  return result_obj.tracks\n         .sort((a, b) => b.popularity - a.popularity)\n         .map((track) => (\n           <div key={track.id} style={{ backgroundImage: `url(${track.album ? track.album.images[0].url : ''})`, margin: 2, backgroundColor: '#999', border: '2px solid #aaa', boxSizing: 'content-box' }}>\n             <div style={{ margin: 5, border: '0.5px solid #aaa', backgroundColor: 'rgba(0, 0, 0, 0.8)', borderRadius: '50%', height: 200, width: 200, display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center' }}>\n               <h1 className=\"artist-name\">{track.artists.map((art, i) => <a className=\"artist-name\" key={art.id + \"\" + i} href={art.external_urls.spotify}>{art.name}</a>).reduce(spanJoiner, [])}</h1>\n               <h2 className=\"song-name\"><a className=\"song-name\" href={track.external_urls.spotify}>{track.name}</a></h2>\n             </div>\n           </div>\n         ));\n}\n\nexport default function Results({ data }) {\n  const reactObjects = Object.keys(data).reduce((accumulator, musicalKey) => {\n    const elements = createDivs(data[musicalKey])\n    if (elements.length) {\n      accumulator.push(<div key={musicalKey} style={{ margin: 2, backgroundColor: GetCamelotWheelColor(musicalKey), width: '100%', color: GetCamelotWheelColorText(musicalKey), boxSizing: 'content-box' }}>\n        <div style={{ margin: 5, display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center' }}>\n          <h1 style={{ fontSize: '2em', margin: 0 }}>{keyText[musicalKey]}</h1>\n        </div>\n      </div>, ...elements)\n    }\n    return accumulator\n  }, [])\n  return reactObjects\n}\n","import React from 'react';\nimport { Snackbar } from '@material-ui/core';\n\nexport default function ErrorSnackbar({ open, error, onClose }) {\n  return (<Snackbar anchorOrigin={{\n    vertical: 'bottom',\n    horizontal: 'left',\n  }} open={open} onClose={onClose} autoHideDuration={6000} ContentProps={{\n    'aria-describedby': 'message-id',\n  }} message={<span id=\"message-id\">Error: {error} </span>} />);\n}\n","import React from 'react';\nimport './App.css';\nimport QueryString from 'query-string'\nimport { getTokenInNewWindow, getRecommendationsBasedOnAttributes, getGenres } from './Spotify';\nimport GenreSelector from './GenreSelector';\nimport KeySelector from './KeySelector';\nimport { Button } from '@material-ui/core';\nimport BPMSlider from './BPMSlider';\nimport SearchBar from './SearchBar';\nimport ResizableFlexbox from './ResizableFlexbox';\nimport Results from './Results';\nimport ErrorSnackbar from './ErrorSnackbar';\n\nconst formatKey = (number, isMinor) => number + (isMinor ? \"B\" : \"A\")\nconst stringToKey = (str) => [ parseInt(str.slice(0, -1)), (str.slice(-1).toLowerCase() === \"b\" ? true : false)]\nconst DEFAULT_TEMPO = 120\nconst DEFAULT_KEY_NUM = 1\nconst DEFAULT_KEY_IS_MINOR = false\nconst website = \"https://www.mohancao.me/mix-companion\"\n\nexport const spanJoiner = (a, b) => {\n  if (a.length === 0) a.push(b)\n  else a.push(<br key={a.length+1}/>, b)\n  return a\n}\n\nconst rotateNumber = (a, b) => (prev, amount) => {\n  amount = prev + amount;\n  amount %= (b - a + 1);\n  if (amount < a) amount += b\n  return amount\n}\n\nconst rotate12 = rotateNumber(1, 12)\n\nclass App extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      number: DEFAULT_KEY_NUM,\n      isMinor: DEFAULT_KEY_IS_MINOR,\n      token: window.localStorage.getItem(\"token\"),\n      expires: window.localStorage.getItem(\"expires\"),\n      availableGenres: ['country', 'classical', 'rock', 'pop', 'blues', 'r-n-b'],\n      results: 'Results go here',\n      selectedBpm: DEFAULT_TEMPO,\n\n      type: \"Track\",\n      query: \"\",\n    }\n  }\n\n  componentDidMount() {\n    /// block start\n    {\n      let queryParams = QueryString.parse(window.location.hash)\n      if (!queryParams) return;\n      let { access_token, expires_in, state } = queryParams;\n      if (window.opener && window.opener.spotifyCallback) {\n        window.opener.spotifyCallback(access_token, expires_in, state)\n      } else if (access_token && expires_in) {\n        let expiry = (new Date().getTime() + (parseInt(expires_in) * 1000 * 0.9))\n        this.setNewToken(access_token, expiry) // always refresh a little earlier than needed (0.9*actual expiry time)\n      }\n      window.history.replaceState(null, null, ' ');\n    }\n    /// block end\n  }\n\n  setNewToken(token, expires) {\n    if (window.localStorage.getItem(\"token\") === token){\n      return;\n    } else {\n      window.localStorage.setItem(\"token\", token)\n      window.localStorage.setItem(\"expires\", expires)\n      this.setState({ token: token, expires: expires })\n    }\n  }\n\n  getToken() {\n    getTokenInNewWindow(\"4a4e5068f705407480266c7e7c8d7dfa\", website).then(({ token, expires }) => {\n      this.setNewToken(token, expires)\n    })\n  }\n\n  setKey(e) {\n    const val = stringToKey(e.target.value)\n    this.setState({ number: val[0] ? val[0] : DEFAULT_KEY_NUM, isMinor: val[1] ? val[1] : DEFAULT_KEY_IS_MINOR })\n  }\n\n  getGenres() {\n    getGenres(this.state.token)\n    .then(x => this.setState({ availableGenres: x.genres }))\n    .catch((code) => {\n      // token expired\n      if (code === 401) this.getToken();\n      else this.setState({ error: ''+code });\n    })\n  }\n\n  startSearch() {\n    const { token, selectedBpm, number, isMinor, type, query } = this.state;\n\n    let errors = ''\n    if (type === \"Genre\" && query && query.length && query.length > 5) errors += \"Sorry, can't have more than 5 genres. \"\n    if (errors) { this.setState({ error: errors }); return; }\n\n    getRecommendationsBasedOnAttributes(token, {\n      genres: (type === 'Genre' ? query : null),\n      bpm: selectedBpm,\n      key: [formatKey(number, isMinor), formatKey(rotate12(number, -1), isMinor), formatKey(rotate12(number, 1), isMinor), formatKey(number, !isMinor)],\n      songs: (type === 'Track' ? query.split(',').map(x => x.trim()) : null),\n      artist: (type === 'Artist' ? query.split(',').map(x => x.trim()) : null),\n    })\n    .then(x => this.setState({ results: x }))\n    .catch((code) => {\n      // token expired\n      if (code === 401) this.getToken()\n      else this.setState({ error: ''+code })\n    })\n  }\n\n  handleBpmChange(e, newValue) {\n    if (e.shiftKey && typeof this.state.selectedBpm === 'number') newValue = [this.state.selectedBpm, newValue] \n    else if (Array.isArray(newValue) && newValue[0] === newValue[1]) newValue = newValue[0]\n    this.setState({ selectedBpm: newValue })\n  }\n\n  setSearchTerms({ query, type }) {\n    if (type) {\n      this.setState({ type, query: '' })\n    } else {\n      this.setState({ query })\n    }\n  }\n\n  render() {\n    const { number, isMinor, token, results, availableGenres, selectedBpm, type, query, error } = this.state;\n    if (!token) return <div className=\"App\" style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}><Button onClick={() => this.getToken()}>Login to Spotify to use this app</Button></div>\n    return (\n      <div className=\"App\">\n        <ErrorSnackbar open={!!error} error={error} onClose={() => this.setState({ error: null })} />\n        <div style={{ backgroundColor: '#eee', padding: 15, boxSizing: 'border-box', display: 'inline-flex', width: '100vw', justifyContent: 'center', flexWrap: 'wrap' }}>\n          <div style={{ display: 'flex', flexDirection: 'column', width: '70%', flex: '1 1 auto', overflow: 'auto' }}>\n            <div style={{ display: 'flex' }}>\n              <KeySelector style={{ flexDirection: 'row', flex: '0 0 auto', alignItems: 'center' }} camelotKey={formatKey(number, isMinor)} onChange={(e) => this.setKey(e)} />\n              <SearchBar style={{ flexDirection: 'row', flex: '1 1 150px', minWidth: '150px', alignItems: 'center', marginLeft: 5 }}\n                         type={type}\n                         value={query}\n                         onChange={(e) => this.setSearchTerms(e)}\n                         GenreSelector={<GenreSelector\n                                         style={{ flexDirection: 'row', flex: '1 1 auto', alignItems: 'center', marginLeft: 5 }}\n                                         selectedGenre={type === 'Genre' && Array.isArray(query) ? query : []} availableGenres={availableGenres}\n                                         onChange={(val) => (val.length <= 5) && this.setState({ query: val })}\n                                         onRefreshClicked={() => this.getGenres()}\n                                        />}\n              />\n            </div>\n            <div style={{ marginTop: 5 }}>\n              <Button style={{ width: '100%' }} color=\"primary\" variant=\"contained\" onClick={() => this.startSearch()}>Start search</Button>\n            </div>\n          </div>\n          <div style={{ flex: '0 1 auto' }}>\n            <BPMSlider onLongPress={() => ('ontouchstart' in document.documentElement) && this.handleBpmChange({}, [50, 250])} selectedBpm={selectedBpm} onBpmChange={(e, newValue) => this.handleBpmChange(e, newValue)} height={75} min={0} max={300} />\n          </div>\n        </div>\n        <div style={{ marginTop: 5 }}>\n          Getting recommendations for <span style={{ }}>{type.toLowerCase()}s</span>\n          <span style={{ color: 'red' }}>\n            {query ? (\" like \" + (Array.isArray(query) ? query.join(', ') : query)) : ''}\n            {(Array.isArray(selectedBpm) && selectedBpm.length === 2 ? ` and only tracks that are ${selectedBpm[0]} to ${selectedBpm[1]} bpm` :\n             (typeof selectedBpm === 'number' ? ` for tracks with ${selectedBpm} (Â± 10) bpm ` : '')\n            )}\n          </span>\n        </div>\n        <div style={{ padding: '20px 0', display: 'flex', justifyContent: 'center' }}>\n          <ResizableFlexbox childrenWidth={219}>\n            <Results data={results} />\n          </ResizableFlexbox>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}